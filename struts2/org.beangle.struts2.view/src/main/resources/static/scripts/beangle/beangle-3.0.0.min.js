(function(window,undefined){function Page(e,t,n,a,r){this.formid="form_"+bg.randomInt(),this.actionurl=e,this.target=t,this.paramMap={},this.params=function(){return this.paramMap},this.pageInfo=function(e,t,n){this.pageNo=e,this.pageSize=t,this.total=n,null!=n&&null!=t&&null!=e?(quotient=Math.floor(n/t),this.maxPageNo=0==n%t?quotient:quotient+1,this.startNo=(e-1)*t+1,this.endNo=n>=this.startNo+t-1?this.startNo+t-1:n):this.maxPageNo=1},this.pageInfo(n,a,r),this.action=function(e){return this.actionurl=e,this},this.orderBy=function(e){return this.orderby=e,this},this.target=function(e,t){return e?this.target=e:t&&(this.target=bg.findTarget(document.getElementById(t))),this},this.getForm=function(){return myForm=document.getElementById(this.formid),null==myForm&&(myForm=document.createElement("form"),myForm.setAttribute("id",this.formid),myForm.setAttribute("action",this.actionurl),myForm.setAttribute("method","POST"),document.getElementById(this.target)?document.getElementById(this.target).appendChild(myForm):document.body.appendChild(myForm)),myForm},this.addParams=function(e){bg.assert.notNull(e,"paramSeq for addHiddens must not be null"),this.paramstr=e;var t,n,a,r=e.split("&");for(t=0;r.length>t;t++)oneParam=r[t],""!=oneParam&&(n=oneParam.substr(0,oneParam.indexOf("=")),a=oneParam.substr(oneParam.indexOf("=")+1),this.paramMap[n]=a);return this},this.checkPageParams=function(e,t,n){if(null!=e){if(!/^[1-9]\d*$/.test(e))return bg.alert("输入分页的页码是:"+e+",它不是个整数"),!1;null!=this.maxPageNo&&e>this.maxPageNo&&(e=this.maxPageNo),this.paramMap.pageNo=e}if(null!=t){if(!/^[1-9]\d*$/.test(t))return bg.alert("输入分页的页长是:"+t+",它不是个整数"),!1;this.paramMap.pageSize=t}return null!=n&&"null"!=n&&(this.paramMap.orderBy=n),!0},this.goPageNormal=function(){var e,t,n=document.createElement("form");n.setAttribute("action",this.actionurl),n.setAttribute("method","POST");for(e in this.paramMap)t=this.paramMap[e],""!=t&&bg.form.addInput(n,e,t,"hidden");document.body.appendChild(n),n.submit()},this.goPageAjax=function(){var e,t,n,a,r,i=this.getForm();for(e in this.paramMap)t=this.paramMap[e],""!=t&&bg.form.addInput(i,e,t,"hidden");n=this.formid+"_submitx",a=document.getElementById(n),null==a&&(a=document.createElement("button"),a.setAttribute("id",n),a.setAttribute("type","submit"),a.style.display="none",i.appendChild(a)),r={},r.jqueryaction="button",r.id=n,r.targets=this.target,r.href=this.actionurl,r.formids=this.formid,jQuery.struts2_jquery.bind(jQuery("#"+n),r),a.click()},this.goPage=function(e,t,n){this.checkPageParams(e,t,n)&&(this.target&&document.getElementById(this.target)?this.goPageAjax(e,t,n):this.goPageNormal(e,t,n))}}if(!beangle){var beangle=function(){return!0};beangle.extend=function(e){for(attr in e){var t,n=attr.split("."),a=beangle;for(t=0;n.length-1>t;t++)a[n[t]]=a[n[t]]||{},a=a[n[t]];a[n[n.length-1]]=e[attr]}},window.beangle=beangle,window.bg=beangle,beangle.ajaxhistory="undefined"!=typeof History&&History.Adapter!==undefined,beangle.displayAjaxMessage=function(){var e="Loading...",t=document.getElementById("messageZone");if(t)t.innerHTML=e,t.style.visibility="visible";else{var t=document.createElement("div");t.setAttribute("id","messageZone"),t.style.position="absolute",t.style.zIndex="1000",t.style.top="0px",t.style.right="0px",t.style.width="55px",t.style.height="20px",t.style.background="#F9EDBE",t.style.padding="2px",document.body.appendChild(t);var n=document.createTextNode(e);t.appendChild(n)}},beangle.hideAjaxMessage=function(){var e=document.getElementById("messageZone");e&&(e.style.visibility="hidden")},beangle.history={init:function(){return"file:"===document.location.protocol?(alert("The HTML5 History API (and thus History.js) do not work on files, please upload it to a server."),undefined):(jQuery(document).ready(function(){History.Adapter.bind(window,"statechange",function(){var e=History.getState();if("undefined"!=jQuery.type((e.data||{}).container)&&"undefined"!=jQuery.type((e.data||{}).content)){if(e.data.updatedAt){var t=(new Date).getTime()-e.data.updatedAt;if(1e3>=t)return}jQuery(e.data.container).html(e.data.content),bg.history.applyState(e)}})}),undefined)},Go:function(e,t){jQuery.ajax({url:e,cache:!1,type:"GET",dataType:"html",complete:function(n){if(t="#"+t,jQuery(t).html().length>0)bg.history.snapshot(),History.pushState({content:n.responseText,container:t},"",e);else{var a=History.getState();History.replaceState({content:n.responseText,container:t,updatedAt:(new Date).getTime()},a.title,a.url),jQuery(t).html(n.responseText)}beangle.hideAjaxMessage()},beforeSend:beangle.displayAjaxMessage})},snapshot:function(){var e=History.getState();if(e.data.content){var t=[];jQuery(e.data.container+" .box:checked").each(function(e,n){t[t.length]=n.value}),e.data.boxes=t,e.updatedAt=(new Date).getTime(),t.length>0&&History.replaceState(e.data,e.title,e.url)}},applyState:function(e){e.data.boxes&&jQuery(e.data.boxes).each(function(t,n){jQuery(e.data.container+" .box[value="+n+"]").attr("checked","checked")})},submit:function(e,t,n){function a(e){return bg.history.snapshot(),History.pushState({content:e,container:n},"",t),bg.hideAjaxMessage(),!1}function r(e){var t=e.responseText;return jQuery(n).html(t),bg.hideAjaxMessage(),!1}"string"==jQuery.type(e)&&0!=e.indexOf("#")&&(e="#"+e),"string"==jQuery.type(n)&&0!=n.indexOf("#")&&(n="#"+n),bg.require("jquery.form"),bg.displayAjaxMessage(),jQuery(e).ajaxForm({success:a,error:r})}},beangle.extend({Go:function(e,t){var n=e;return"object"==typeof e&&"a"==e.tagName.toLowerCase()&&(n=e.href,t||(t=bg.findTarget(e))),t||(t="_self"),"_self"==t?self.location=n:"_parent"==t?self.parent.location=n:"_top"==t?self.top.location=n:"_new"==t||"_blank"==t?window.open(n):bg.isAjaxTarget(t)?beangle.ajaxhistory?beangle.history.Go(n,t):jQuery("#"+t).load(n,{}):document.getElementById(t).src=n,!1},getContextPath:function(){return self.location.pathname.substring(0,self.location.pathname.substring(1).indexOf("/")+1)},ready:function(e){jQuery(document).ready(e)},isAjaxTarget:function(e){return e?""==e||"_new"==e||"_blank"==e||"_self"==e||"_parent"==e||"_top"==e?!1:(targetEle=document.getElementById(e))?(tagName=targetEle.tagName.toLowerCase(),"iframe"==tagName||"object"==tagName?!1:!0):!1:!1},normalTarget:function(e){if(""==e||"new"==e||"_blank"==e||"_self"==e||"_parent"==e)return e;var t=document.getElementById(e);return t&&"iframe"==t.tagName.toLowerCase()?e:"_self"},findTarget:function(e){for(var t=e.parentNode,n="_self";t;){if(t.id&&t.className&&t.className.indexOf("ajax_container")>-1){n=t.id;break}t=t==t.parentNode?null:t.parentNode}return e.target=n,n}}),beangle.extend({assert:{notNull:function(e,t){null==e&&alert(t)}}}),bg.extend({randomInt:function(){var e=1e7*Math.random();return e-=e%1}}),beangle.extend({logger:{level:1,debug:function(e){if(0>=beangle.logger.level){var t="[beangle] "+e;window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError?window.opera.postError(t):alert(t)}}}}),beangle.extend({event:{portable:function(e){return e?e:window.event},getTarget:function(e){return e=bg.event.portable(e),e.target||e.srcElement}}}),beangle.extend({input:{toggleCheckBox:function(e,t){bg.input.boxAction(e,"toggle",t)},getRadioValue:function(e){return bg.input.boxAction(document.getElementsByName(e),"value")},getCheckBoxValues:function(e){var t=bg.input.boxAction(document.getElementsByName(e),"value");return null==t?"":t},boxAction:function(e,t,n){var a,r,i="";if(e)if(e[0])for(r=0;e.length>r;r++)if("selected"==t){if(e[r].checked)return e[r].checked}else"value"==t?e[r].checked&&("radio"==e[r].type?i=e[r].value:"checkbox"==e[r].type&&(""!=i&&(i+=","),i+=e[r].value)):"toggle"==t&&(a=beangle.event.getTarget(n),e[r].checked=a.checked,"function"==typeof e[r].onchange&&e[r].onchange());else{if("selected"==t)return e.checked;"value"==t?e.checked&&(i=e.value):"toggle"==t&&(a=beangle.event.getTarget(n),e.checked=a.checked,"function"==typeof e.onchange&&e.onchange())}return"selected"==t?!1:i}}}),beangle.extend({iframe:{adaptSelf:function(){bg.iframe.adapt(self)},adapt:function(e,t){var n,a,r,i;null!=e&&""!=e.name&&e.parent!=e&&(e.parent!=window.top||"hidden"!=e.parent.document.body.style.overflowY)&&(n=e.parent.document.getElementsByName(e.name),1>n.length||(a=n[0],null==a||"no"!=a.scrolling&&"autoadapt"!=a.className||(r=e.document.body.scrollHeight+(null==t?0:t),i=0,a.style.height&&(i=parseInt(a.style.height.substring(0,a.style.height.length-2))),r>0&&r>i&&(a.style.height=r+"px",bg.logger.debug("adapt frame:"+e.name+" height "+a.style.height))),bg.iframe.adapt(e.parent)))}}}),beangle.extend({form:{submit:function(myForm,action,target,onsubmit,ajax,noHistory){var submitTarget,rs,sumbitBtnId,submitx,origin_target,origin_action,options_submit;if("string"==typeof myForm&&(myForm=document.getElementById(myForm)),myForm.onsubmit){rs=null;try{rs=myForm.onsubmit()}catch(e){return alert(e),undefined}if(0==rs)return}if(onsubmit){if(rs=null,"function"==typeof onsubmit)try{rs=onsubmit(myForm)}catch(e){return alert(e),undefined}else rs=eval(onsubmit);if(0==rs)return}submitTarget=null!=target?target:myForm.target,submitTarget||(submitTarget=bg.findTarget(myForm)),null==action&&(action=myForm.action),0==action.indexOf("http://")&&(action=action.substring(action.indexOf("/",7))),(null==ajax||ajax)&&(ajax=bg.isAjaxTarget(submitTarget)),origin_target=myForm.target,origin_action=myForm.action,myForm.action=action,ajax?((null==myForm.id||""==myForm.id)&&myForm.setAttribute("id",myForm.name),sumbitBtnId=myForm.id+"_submit",submitx=document.getElementById(sumbitBtnId),null==submitx&&(submitx=document.createElement("input"),submitx.setAttribute("id",sumbitBtnId),submitx.setAttribute("type","submit"),submitx.style.display="none",myForm.appendChild(submitx)),options_submit={id:sumbitBtnId,jqueryaction:"button",targets:submitTarget,href:"#"},origin_onsubmit=myForm.onsubmit,"undefined"!=typeof jQuery&&(!noHistory&&0==jQuery("input:file",myForm).length&&beangle.ajaxhistory?(beangle.history.submit(myForm.id,action,submitTarget),myForm.onsubmit=null):jQuery.struts2_jquery.bind(jQuery("#"+sumbitBtnId),options_submit)),submitx.click(),myForm.onsubmit=origin_onsubmit,jQuery("#"+sumbitBtnId).unbind()):(myForm.target=bg.normalTarget(submitTarget),myForm.submit(),myForm.target=origin_target),myForm&&(myForm.action=origin_action)},submitId:function(e,t,n,a,r,i){var o=bg.input.getCheckBoxValues(t);return null==n&&(n=!1),""==o?(alert(n?"请选择一个或多个进行操作":"请选择一个进行操作"),undefined):!n&&o.indexOf(",")>0?(alert("请仅选择一个"),undefined):(null!=a?e.action=a:a=e.action,bg.form.addInput(e,n?t+"s":t,o,"hidden"),(null==r||confirm(r))&&bg.form.submit(e,a,null,null,i),undefined)},addInput:function(e,t,n,a){if(null!=e[t]&&"string"!=typeof e[t])e[t].value=n;else{null==a&&(a="hidden");var r=document.createElement("input");r.setAttribute("name",t),r.setAttribute("value",n),r.setAttribute("type",a),e.appendChild(r)}},ecodeParams:function(e){if(""==e)return"";var t,n,a=e.split("&"),r="";for(t=0;a.length>t;t++)""!=a[t]&&(n=a[t].indexOf("="),r+="&"+a[t].substr(0,n),-1!=n&&(r+="=",r+=escape(a[t].substr(n+1))));return r},setSearchParams:function(e,t,n){bg.form.addInput(t,"params","");var a=bg.form.getInputParams(e,n,!1);bg.form.addInput(t,"params",a)},addHiddens:function(e,t){bg.assert.notNull(t,"paramSeq for addHiddens must not be null");var n,a,r,i=t.split("&");for(n=0;i.length>n;n++)""!=i[n]&&(a=i[n].substr(0,i[n].indexOf("=")),r=i[n].substr(i[n].indexOf("=")+1),bg.form.addInput(e,a,r,"hidden"))},addParamsInput:function(e,t){bg.form.addInput(e,"params",t,"hidden")},transferParams:function(e,t,n,a){null==a&&(a=!0);var r=bg.form.getInputParams(e,n,a);bg.form.addHiddens(t,r)},getInputParams:function(e,t,n){var a,r=e.elements,i="";for(null==n&&(n=!0),a=0;r.length>a;a++)if(""!=r[a].name){if("params"==r[a].name)continue;if(""==r[a].value&&0==n)continue;if(null!=t){if(0==r[a].name.indexOf(t)&&r[a].name.indexOf(".")>1){if(("radio"==r[a].type||"checkbox"==r[a].type)&&0==r[a].checked)continue;i+=-1!=r[a].value.indexOf("&")?"&"+r[a].name+"="+escape(r[a].value):"&"+r[a].name+"="+r[a].value}}else{if(("radio"==r[a].type||"checkbox"==r[a].type)&&0==r[a].checked)continue;i+=-1!=r[a].value.indexOf("&")?"&"+r[a].name+"="+escape(r[a].value):"&"+r[a].name+"="+r[a].value}}return i},goToPage:function(e,t,n,a){if("object"!=typeof e)return alert("[goToPage:]form is not well defined."),undefined;if(null!=t){if(!/^[1-9]\d*$/.test(t))return alert("输入分页的页码是:"+t+",它不是个整数"),undefined;bg.form.addInput(e,"pageNo",t,"hidden")}else bg.form.addInput(e,"pageNo",1,"hidden");if(null!=n){if(!/^[1-9]\d*$/.test(n))return alert("输入分页的页长是:"+n+",它不是个整数"),undefined;bg.form.addInput(e,"pageSize",n,"hidden")}else bg.form.addInput(e,"pageSize","","hidden");null!=a&&"null"!=a?bg.form.addInput(e,"orderBy",a,"hidden"):bg.form.addInput(e,"orderBy","","hidden"),e.submit()},goToFirstPage:function(e){bg.form.goToPage(e,1)}}}),beangle.extend({select:{getValues:function(e){var t,n="",a=e.options;for(t=0;a.length>t;t++)""!=n&&(n+=","),n+=a[t].value;return n},getSelectedValues:function(e){var t,n="",a=e.options;for(t=0;a.length>t;t++)a[t].selected&&(""!=n&&(n+=","),n+=a[t].value);return n},hasOption:function(e,t){for(var n=0;e.length>n;n++)if(e.options[n].value==t.value)return!0;return!1},moveSelected:function(e,t){var n,a;for(n=0;e.length>n;n++)e.options[n].selected&&(a=e.options[n],bg.select.hasOption(t,a)||(t.options[t.length]=new Option(a.text,a.value)));bg.select.removeSelected(e),bg.select.clearStatus(e)},clearStatus:function(e){for(var t=0;e.options.length>t;t++)e.options[t].selected=!1},selectAll:function(e){for(var t=0;e.options.length>t;t++)e.options[t].selected=!0;return e.options.length>0},removeSelected:function(e){var t,n=e.options;for(t=n.length-1;t>=0;t--)n[t].selected&&(n[t]=null)},setSelected:function(e,t){0!=t.indexOf(",")&&(t=","+t),t.lastIndexOf(",")!=t.length-1&&(t+=",");for(var n=0;e.options.length>n;n++)-1!=t.indexOf(","+e.options[n].value+",")&&(e.options[n].selected=!0)}}}),beangle.extend({cookie:{get:function(e){var t,n=document.cookie,a=n.indexOf(e+"=");return-1==a?null:(a+=e.length+1,t=n.indexOf(";",a),-1==t?unescape(n.substring(a)):unescape(n.substring(a,t)))},set:function(e,t,n){null==n&&(n="/");var a=new Date;a.setTime(a.getTime()+2592e3),document.cookie=e+"="+t+"; expires="+a.toGMTString()+"; path="+n}}}),bg.extend({page:function(e,t){return new Page(e,t)}}),bg.onReturn=function(e,t){e||(e=window.event),e&&e.keyCode&&13==e.keyCode&&t()},bg.extend({require:function(e,t){var n=bg.getContextPath();"jquery.form"==e&&jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-form-3.09.js",t,n)}}),beangle.ready(beangle.iframe.adaptSelf),beangle.ajaxhistory&&beangle.history.init()}})(window);