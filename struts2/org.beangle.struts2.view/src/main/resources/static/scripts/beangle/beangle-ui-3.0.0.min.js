(function(g){function m(a,d){this.name=a;this.func=d}function p(a,d,c){function f(b,a){var e="action-default";if(null!=a)if(a.indexOf(".")>-1)return a.charAt(0)!="/"&&(a=n+a),'<img class="toolbar-icon" src="'+a+'"/>';else e=a;if(null==a&&null!=b){if(typeof b=="object")b=b.name;typeof b=="string"&&(b.indexOf("add")==0||b.indexOf("batchAdd")==0||b.indexOf("new")==0?e="action-new":b.indexOf("remove")==0||b.indexOf("delete")==0?e="action-edit-delete":b.indexOf("update")==0||b.indexOf("edit")==0||b.indexOf("batchEdit")==
0?e="action-update":b.indexOf("export")==0?e="action-excel":b.indexOf("copy")==0?e="action-edit-copy":b.indexOf("print")==0?e="action-print":b.indexOf("refresh")==0?e="action-refresh":b.indexOf("close")==0?e="action-close":b.indexOf("save")==0?e="action-save":b.indexOf("download")==0&&(e="action-download"))}return'<span class="toolbar-icon '+e+'" ></span>'}function k(b,a){if(null==a)g.alert("action should not be null");else if(typeof a=="function")b.onclick=a;else{if(typeof a=="string")a.indexOf("(")!=
-1?b.onclick=function(){eval(a)}:a.indexOf(".action")!=-1?b.onclick=function(){Go(a)}:g.alert("unsuported action description:"+a);if(typeof a=="object")b.onclick=a.func}}function e(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;var a=b.lastElementChild||b.lastChild;null==a?alert("menu is null then return and target is "+b):a.style.visibility!=""&&a.style.visibility!="hidden"?(a.style.visibility="hidden",b.className="toolbar-item-transfer"):(a.style.visibility="visible",
b.className="toolbar-item-selected")}function h(b,a){var h=document.createElement("table");h.className="toolbar-menu";h.id=b+"Table";var c=document.createElement("tbody");h.appendChild(c);if(jQuery("#"+b).find("span").length>0)h.onclick=function(b){e(b)};a.appendChild(h);this.table=h;this.addItem=function(b,a,e,h){var c=document.createElement("td");c.innerHTML=f(a,e)+b;c.onmouseout=j;c.onmouseover=i;c.title=h||b;k(c,a);c.className="toolbar-menuitem";c.width="100%";b=document.createElement("tr");b.appendChild(c);
this.table.tBodies.length==0&&this.table.appendChild(document.createElement("tbody"));this.table.tBodies[0].appendChild(b)}}function j(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="td";)b=b.parentNode;if(b)b.className="toolbar-menuitem"}function i(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="td";)b=b.parentNode;if(b)b.className="toolbar-menuitem-transfer"}function l(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;if(b)b.className="toolbar-item-transfer"}
function o(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;if(b)b.className="toolbar-item"}this.itemCount=0;this.bar=document.getElementById(a);if(null!=this.bar){this.id=a;this.separator="&nbsp;";this.bar.className="toolbar notprint";var n=self.location.pathname.substring(0,self.location.pathname.substring(1).indexOf("/")+1)+"/static/themes/"+g.uitheme+"/icons/16x16/actions/";this.setTitle=function(b,a){if(b)a==null&&(a="action-info"),this.title_div.innerHTML=f(null,
a)+"<strong>"+b+"</strong>"};this.setSeparator=function(b){this.separator=b};this.init=function(b,a){var e=document.createElement("div");e.className="toolbar-title";this.bar.appendChild(e);this.title_div=e;this.setTitle(b,a);e=document.createElement("div");e.className="toolbar-msg";e.id=this.id+"_msg";this.bar.appendChild(e);e=document.createElement("div");e.className="toolbar-items";e.id=this.id+"_items";this.items_div=e;this.bar.appendChild(e)};this.init(d,c);this.addHr=function(){hrdiv=this.appendDiv(null,
"toolbar-line");hrdiv.innerHTML='<img height="1" width="100%" align="top" src="'+n+'keyline.png" />'};this.addBack=function(b){null==b?this.addItem("\u8fd4\u56de",function(){history.back(-1)},"action-backward"):this.addItem(b,function(){history.back(-1)},"action-backward")};this.addHelp=function(b){this.addItem("\u5e2e\u52a9",function(){null==b?g.alert("\u65bd\u5de5\u4e2d.."):window.open("help.action?helpId="+b)},"action-help-contents")};this.addPrint=function(b){null==b?this.addItem("\u6253\u5370",
"print()"):this.addItem(b,"print()")};this.addClose=function(b){if(""==b||null==b)b="\u5173\u95ed";this.addItem(b,"window.close()","action-close")};this.addItem=function(b,a,e,c){this.addSeparatorAsNeed();var h=document.createElement("div");h.innerHTML=f(a,e)+b;h.onmouseout=o;h.onmouseover=l;k(h,a);h.className="toolbar-item";h.title=c==null?b:c;this.items_div.appendChild(h);this.itemCount++;return h};this.addDiv=function(b){var a=document.createElement("div");if(b)a.className=b;this.items_div.appendChild(a);
return a};this.appendDiv=function(a,e){var h=document.createElement("div");a&&h.setAttribute("id",a);if(e)h.className=e;document.getElementById(this.id).appendChild(h);return h};this.addSeparator=function(){if(this.separator)this.addDiv("toolbar-separator").innerHTML=this.separator};this.addSeparatorAsNeed=function(){this.itemCount!=0&&this.addSeparator()};this.addBackOrClose=function(a,e){parent.location==self.location&&(window.history.length<=1||window.history.length==null)?this.addClose(null==
e?"\u5173\u95ed":e):this.addBack(null==a?"\u540e\u9000":a)};this.addBlankItem=function(){this.addDiv("toolbar-group-separator").innerHTML="&nbsp;";this.itemCount++};this.setMessage=function(a){if(typeof a!="undefined")document.getElementById(this.id+"_msg").innerHTML=a};this.addMenu=function(a,c,d,i){this.addSeparatorAsNeed();var j=document.createElement("div");j.className="toolbar-item";var n=this.id+this.itemCount+"_menu";j.id=n;j.tabIndex=0;j.title=i||a;j.onmouseout=o;j.onmouseover=l;this.items_div.appendChild(j);
c==null?(j.innerHTML=f(null,d)+a+"&nbsp;"+f(null,"action-downarrow"),j.onclick=function(a){e(a)}):(i=document.createElement("span"),i.innerHTML=f(c,d)+a,k(i,c),a=document.createElement("span"),a.innerHTML=f(c,"action-downarrow"),a.onclick=function(a){e(a)},j.appendChild(i),j.appendChild(a));j.onblur=function(a){a:{for(var b=g.event.getTarget(a);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;a=b.lastElementChild||b.lastChild;if(null==a||a.tagName.toLowerCase()!="table")alert("menu is null then return and target is "+
b);else if(a.style.visibility!=""&&a.style.visibility!="hidden"){for(b=0;b<a.rows.length;b++)if(a.rows[b].cells[0].className=="toolbar-menuitem-transfer")break a;a.style.visibility="hidden"}}};c=new h(n,j);this.itemCount++;return c}}}g.alert=function(a){alert(a)};g.uitheme="default";g.extend({"ui.toolbar":function(a,d,c){return new p(a,d,c)}});g.extend({"ui.gridbar":function(a,d){function c(a,e,h,c,f){for(var d=[],g=0;g<f.length;g++)d[g]=f[g].addMenu(a,e,h,c);this.addItem=function(a,b,e,h){for(var c=
0;c<d.length;c++)d[c].addItem(a,b,e,h)}}this.divIds=a;this.pageId=null;this.title=d;this.toolbars=[];for(var f=0;f<a.length;f++)this.toolbars[f]=g.ui.toolbar(a[f],d),this.toolbars[f].setSeparator(""),document.getElementById(a[f]).className="gridbar",document.getElementById(a[f]+"_items").className="gridbar-items";this.pageId=function(a){this.pageId=a;return this};this.addItem=function(a,e,c,d){for(var f=0;f<this.toolbars.length;f++)this.toolbars[f].addItem(a,e,c,d)};this.addBack=function(a){for(var e=
0;e<this.toolbars.length;e++)this.toolbars[e].addBack(a)};this.addBackOrClose=function(){for(var a=0;a<this.toolbars.length;a++)this.toolbars[a].addBackOrClose()};this.addBlankItem=function(a,e,c,f){for(var d=0;d<this.toolbars.length;d++)this.toolbars[d].addBlankItem(a,e,c,f)};this.addPage=function(c,e,h){this.myPage=c;for(var d=0;d<this.toolbars.length;d++)pageDiv=this.toolbars[d].appendDiv(a[d]+"_page","girdbar-pgbar"),g.ui.pagebar(c,pageDiv,e,h);return this};this.addEntityAction=function(a,e){return new g.entityaction(a,
e)};this.addPrint=function(a){for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].addPrint(a)};this.addMenu=function(a,e,h,d){return new c(a,e,h,d,this.toolbars)}}});g.extend({"ui.pagebar":function(a,d,c,f){if(a.total!=0){c?c.length==0&&(c=[a.pageSize]):c=[10,20,30,50,70,100,200,500,1E3];f||(f={first:"\u00ab First",previous:"\u2039 Previous",next:"Next \u203a",last:"Last \u00bb",no:"No:",size:"Size:",change:"Click me to change page size",pagesize:"Page Size"});var g=a.maxPageNo;addAnchor=function(e,
c){var b=document.createElement("a");b.setAttribute("href","#");b.innerHTML=e;b.style.padding="0px 2px 0px 2px";d.appendChild(b);jQuery(b).click(function(){a.goPage(c)})};a.pageNo>1&&(addAnchor(f.first,1),addAnchor(f.previous,a.pageNo-1));var e=document.createElement("span");e.innerHTML="<strong>"+a.startNo+"</strong> - <strong>"+a.endNo+"</strong> of <strong>"+a.total+"</strong>";e.style.padding="0px 2px 0px 2px";d.appendChild(e);e=jQuery(e);e.attr("title",f.change);e.mouseover(function(){this.className=
"pgbar-label"});e.mouseout(function(){this.className=""});e.click(function(){this.parentNode.style.marginTop="0px";this.nextSibling.style.display="";this.style.display="none"});e=document.createElement("span");e.style.display="none";var h=document.createElement("input");e.innerHTML=f.no;h.className="pgbar-input";e.appendChild(h);h=jQuery(h);h.attr("value",a.pageNo+"/"+g);h.attr("id",d.id+"_input");h.focus(function(){this.value=""});h.blur(function(){if(!this.value)this.value=a.pageNo+"/"+g});if(c&&
c.length>0){h=document.createElement("select");h.id=d.id+"_select";e.appendChild(h);h.className="pgbar-selbox";h.title=f.pagesize||"Page Size";for(var j=0,i=0;i<c.length;i++)c[i]==a.pageSize&&(j=i),h.options.add(new Option(c[i],c[i]));h.selectedIndex=j}c=document.createElement("input");c.setAttribute("type","button");c.setAttribute("name","gogo");c.value="Go";c.className="pgbar-go";e.appendChild(c);var l=function(){var e=document.getElementById(d.id+"_input").value,c=e.indexOf("/"+a.maxPageNo);-1!=
c&&(e=e.substring(0,c));a.goPage(e,document.getElementById(d.id+"_select").value)};jQuery(c).click(function(){l()});d.appendChild(e);jQuery(e).keypress(function(a){if(!a)a=window.event;if(a&&a.keyCode&&a.keyCode==13)return l(),!1});a.pageNo<a.maxPageNo&&(addAnchor(f.next,a.pageNo+1),addAnchor(f.last,a.maxPageNo))}}});g.extend({"ui.grid":{overSortTableHeader:function(){this.style.color="white";this.style.backgroundColor="green"},outSortTableHeader:function(){this.style.borderColor="";this.style.color=
"";this.style.backgroundColor=""},mouseOverGrid:function(){if(typeof this.className!="undefined"){var a=this.className;selectIndex=a.indexOf("griddata-selected");if(-1==selectIndex)overIndex=a.indexOf("griddata-over"),this.className=-1==overIndex?a+" griddata-over":a.substring(0,overIndex)}},onRowChange:function(a){var a=g.event.getTarget(a),d=!0;if(null!=a&&a.tagName.toLowerCase()=="td"){for(a=a.parentNode.firstChild;a.tagName==null||a.tagName.toLowerCase()!="td";)a=a.nextSibling;for(a=a.firstChild;typeof a.tagName==
"undefined"||a.tagName.toLowerCase()!="input";)if(a=a.nextSibling,a==null)return;a.checked=!a.checked}else a.type=="checkbox"||a.type=="radio"||(d=!1);if(null!=a&&d){if(typeof a.onchange=="function")a.onchange();if(a.type!="radio"&&(d=a.parentNode.parentNode,typeof d.className!="undefined")){var c=d.className.indexOf("griddata-selected");if(a.checked)-1==c&&(d.className+=" griddata-selected");else if(-1!=c)d.className=d.className.substring(0,c)}}},sort:function(a,d){if(null==a)g.alert("\u65e0\u6cd5\u627e\u5230\u5143\u7d20\u5bf9\u5e94\u7684\u6392\u5e8f\u8868\u683c\uff01");
else{var c=null,c=d.className=="gridhead-sortable"?typeof d.asc!="undefined"?d.asc:d.id+" asc":d.className=="gridhead-asc"?typeof d.desc!="undefined"?d.desc:d.id.replace(/\,/g," desc,")+" desc":"";a.goPage(1,null,c)}},init:function(a,d){var c=document.getElementById(a).tHead,f,k,e,h,j,i,l;if(c&&c.rows.length!=0){f=d.orderby;k=function(){g.ui.grid.sort(d,this)};for(h=0;h<c.rows.length;h++){j=c.rows[h];for(e=0;e<j.cells.length;e++)if(i=j.cells[e],i.className=="gridhead-sortable"&&null!=i.id){i.onclick=
k;i.onmouseover=g.ui.grid.overSortTableHeader;i.onmouseout=g.ui.grid.outSortTableHeader;i.title="\u70b9\u51fb\u6309 ["+i.innerHTML+"] \u6392\u5e8f";l=i.id.replace(/\,/g," desc,")+" desc";if(typeof i.desc!="undefined")l=i.desc;if(f.indexOf(l)!=-1)i.className="gridhead-desc",i.innerHTML+='<span class="gridhead-icon action-sort-desc"></span>';else{l=i.id+" asc";if(typeof i.asc!="undefined")l=i.asc;if(f==l)i.className="gridhead-asc",i.innerHTML+='<span class="gridhead-icon action-sort-asc"></span>'}}}if(c=
document.getElementById(a+"_data"))for(h=0;h<c.rows.length;h++)f=c.rows[h],k=(k=f.className)?" "+k:"",f.className=h%2==1?"griddata-odd"+k:"griddata-even"+k,f.onclick=g.ui.grid.onRowChange,f.onmouseover=g.ui.grid.mouseOverGrid,f.onmouseout=g.ui.grid.mouseOverGrid}},fillEmpty:function(a,d,c,f){a=document.getElementById(a);d-=c;d>7&&(d=7);d*=16;if(c==0)c=document.createElement("div"),c.innerHTML=f||"No result matched your search.",c.style.paddingTop=d/2-16+"px",a.appendChild(c);a.style.height=d+"px"}}});
g.extend({entityaction:function(a,d){function c(a,c){var d=a.lastIndexOf("!"),f=a.lastIndexOf("."),g=a,k="";-1==d&&(d=f);-1!=d&&(g=a.substring(0,d));-1!=f&&(k=a.substring(f));return g+"!"+c+k}this.entity=a;this.page=d;this.formid="form_"+g.randomInt();var f=this;this.getForm=function(){return this.page.getForm()};this.addParam=function(a,c){g.form.addInput(this.getForm(),a,c)};if(null!=this.page.target&&""!=this.page.target){var k=this.getForm();if(null!=k)k.target=this.page.target}this.beforeSubmmitId=
function(e){var d=g.input.getCheckBoxValues(a+".id");if(d==null||d=="")return g.alert("\u4f60\u6ca1\u6709\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55\uff01"),!1;d=this.getForm();d.action=c(this.page.actionurl,e);this.page.paramstr&&(g.form.addHiddens(d,this.page.paramstr),g.form.addParamsInput(d,this.page.paramstr));return!0};this.submitIdAction=function(a,c,d,f){this.beforeSubmmitId(a)&&(!(null!=d&&""!=d)||confirm(d))&&g.form.submitId(this.getForm(),this.entity+".id",c,null,null,f)};this.remove=
function(a){a=a||"\u786e\u8ba4\u5220\u9664?";return new m("remove",function(){f.submitIdAction("remove",!0,a)})};this.add=function(){return new m("add",function(){var a=f.getForm();""!=f.page.paramstr&&g.form.addHiddens(a,f.page.paramstr);g.form.addInput(a,f.entity+".id","");""!=f.page.paramstr&&g.form.addParamsInput(a,f.page.paramstr);g.form.submit(a,c(f.page.actionurl,"edit"))})};this.info=function(){return new m("info",function(){f.submitIdAction("info",!1)})};this.edit=function(){return new m("edit",
function(){f.submitIdAction("edit",!1)})};this.single=function(a,c,d){return new m(a,function(){var i=f.getForm();null!=d&&g.form.addHiddens(i,d);f.submitIdAction(a,!1,c)})};this.multi=function(a,c,d,i){return new m(a,function(){try{var l=f.getForm();null!=d&&g.form.addHiddens(l,d);f.submitIdAction(a,!0,c,i)}catch(k){g.alert(k)}})};this.method=function(a,d,j,i){return new m(a,function(){var k=f.getForm();if(!(null!=d&&""!=d)||confirm(d))null!=j&&g.form.addHiddens(k,j),""!=f.page.paramstr&&(g.form.addHiddens(k,
f.page.paramstr),g.form.addParamsInput(k,f.page.paramstr)),g.form.submit(k,c(f.page.actionurl,a),null,null,i)})};this.exportData=function(a,c,d){c=c||"xls";a=a||"";d=d||"";d.indexOf("&")!=0&&(d="&"+d);return f.method("export",null,"&format="+c+"&properties="+a+d,!1)}}});g.extend({"ui.module":{moduleClick:function(a){a=document.getElementById(a);a.className=a.className=="module collapsed"?"module expanded":"module collapsed"}}});g.extend({"ui.load":function(a,d){var c=g.getContextPath();a=="validity"?
(jQuery.struts2_jquery.requireCss("/static/themes/"+g.uitheme+"/jquery.validity.css",c),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery.validity-1.1.1.js",null,c),jQuery.struts2_jquery.scriptCache["/static/scripts/i18n/zh_CN/jquery.validity.js"]&&d?d():jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery.validity.js",d,c)):a=="tabletree"?(jQuery.struts2_jquery.requireCss("/static/themes/"+g.uitheme+"/beangle-ui-tabletree.css",c),jQuery.struts2_jquery.require("/static/scripts/beangle/beangle-ui-tabletree.js",
d,c)):a=="colorbox"?(jQuery.struts2_jquery.requireCss("/static/themes/"+g.uitheme+"/colorbox.css",c),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-colorbox-1.3.17.1.min.js",d,c)):a=="jquery.pstrength"&&(jQuery.struts2_jquery.requireCss("/static/themes/"+g.uitheme+"/jquery-pstrength.css",c),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-pstrength.2.1.js",d,c),jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery-pstrength.js",d,c))}})})(beangle);
