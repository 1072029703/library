(function(g){function m(a,c){this.name=a;this.func=c}function p(a,c,d){function f(b,a){var e="action-default";if(null!=a)if(a.indexOf(".")>-1)return a.charAt(0)!="/"&&(a=o+a),'<img class="toolbar-img" src="'+a+'"/>';else e=a;if(null==a&&null!=b){if(typeof b=="object")b=b.name;typeof b=="string"&&(b.indexOf("add")==0||b.indexOf("batchAdd")==0||b.indexOf("new")==0?e="action-new":b.indexOf("remove")==0||b.indexOf("delete")==0?e="action-edit-delete":b.indexOf("update")==0||b.indexOf("edit")==0||b.indexOf("batchEdit")==
0?e="action-update":b.indexOf("export")==0?e="action-excel":b.indexOf("copy")==0?e="action-edit-copy":b.indexOf("print")==0?e="action-print":b.indexOf("refresh")==0?e="action-refresh":b.indexOf("close")==0?e="action-close":b.indexOf("save")==0?e="action-save":b.indexOf("download")==0&&(e="action-download"))}return'<span class="toolbar-icon '+e+'" ></span>'}function j(b,a){if(null==a)g.alert("action should not be null");else if(typeof a=="function")b.onclick=a;else{if(typeof a=="string")a.indexOf("(")!=
-1?b.onclick=function(){eval(a)}:a.indexOf(".action")!=-1?b.onclick=function(){Go(a)}:g.alert("unsuported action description:"+a);if(typeof a=="object")b.onclick=a.func}}function e(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;var a=b.lastElementChild||b.lastChild;null==a?alert("menu is null then return and target is "+b):a.style.visibility!=""&&a.style.visibility!="hidden"?(a.style.visibility="hidden",b.className="toolbar-item-transfer"):(a.style.visibility="visible",
b.className="toolbar-item-selected")}function k(b,a){var d=document.createElement("table");d.className="toolbar-menu";d.id=b+"Table";var c=document.createElement("tbody");d.appendChild(c);if(jQuery("#"+b).find("span").length>0)d.onclick=function(b){e(b)};a.appendChild(d);this.table=d;this.addItem=function(b,a,e,d){var c=document.createElement("td");c.innerHTML=f(a,e)+b;c.onmouseout=i;c.onmouseover=h;c.title=d||b;j(c,a);c.className="toolbar-menuitem";c.width="100%";b=document.createElement("tr");b.appendChild(c);
this.table.tBodies.length==0&&this.table.appendChild(document.createElement("tbody"));this.table.tBodies[0].appendChild(b)}}function i(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="td";)b=b.parentNode;if(b)b.className="toolbar-menuitem"}function h(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="td";)b=b.parentNode;if(b)b.className="toolbar-menuitem-transfer"}function l(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;if(b)b.className="toolbar-item-transfer"}
function n(b){for(b=g.event.getTarget(b);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;if(b)b.className="toolbar-item"}this.itemCount=0;this.bar=document.getElementById(a);if(null!=this.bar){this.id=a;this.separator="&nbsp;";this.bar.className="toolbar notprint";var o=self.location.pathname.substring(0,self.location.pathname.substring(1).indexOf("/")+1)+"/static/themes/"+g.uitheme+"/icons/16x16/actions/";this.setTitle=function(b,a){if(b)a==null&&(a="action-info"),this.title_div.innerHTML=f(null,
a)+"<strong>"+b+"</strong>"};this.setSeparator=function(b){this.separator=b};this.init=function(b,a){var e=document.createElement("div");e.className="toolbar-title";this.bar.appendChild(e);this.title_div=e;this.setTitle(b,a);e=document.createElement("div");e.className="toolbar-msg";e.id=this.id+"_msg";this.bar.appendChild(e);e=document.createElement("div");e.className="toolbar-items";e.id=this.id+"_items";this.items_div=e;this.bar.appendChild(e)};this.init(c,d);this.addHr=function(){hrdiv=this.appendDiv(null,
"toolbar-line");hrdiv.innerHTML='<img height="1" width="100%" align="top" src="'+o+'keyline.png" />'};this.addBack=function(b){null==b?this.addItem("\u8fd4\u56de",function(){history.back(-1)},"action-backward"):this.addItem(b,function(){history.back(-1)},"action-backward")};this.addHelp=function(b){this.addItem("\u5e2e\u52a9",function(){null==b?g.alert("\u65bd\u5de5\u4e2d.."):window.open("help.action?helpId="+b)},"action-help-contents")};this.addPrint=function(b){null==b?this.addItem("\u6253\u5370",
"print()"):this.addItem(b,"print()")};this.addClose=function(b){if(""==b||null==b)b="\u5173\u95ed";this.addItem(b,"window.close()","action-close")};this.addItem=function(b,a,e,d){this.addSeparatorAsNeed();var c=document.createElement("div");c.innerHTML=f(a,e)+b;c.onmouseout=n;c.onmouseover=l;j(c,a);c.className="toolbar-item";c.title=d==null?b:d;this.items_div.appendChild(c);this.itemCount++;return c};this.addDiv=function(b){var a=document.createElement("div");if(b)a.className=b;this.items_div.appendChild(a);
return a};this.appendDiv=function(a,e){var d=document.createElement("div");a&&d.setAttribute("id",a);if(e)d.className=e;document.getElementById(this.id).appendChild(d);return d};this.addSeparator=function(){if(this.separator)this.addDiv("toolbar-separator").innerHTML=this.separator};this.addSeparatorAsNeed=function(){this.itemCount!=0&&this.addSeparator()};this.addBackOrClose=function(a,e){parent.location==self.location&&(window.history.length<=1||window.history.length==null)?this.addClose(null==
e?"\u5173\u95ed":e):this.addBack(null==a?"\u540e\u9000":a)};this.addBlankItem=function(){this.addDiv("toolbar-group-separator").innerHTML="&nbsp;";this.itemCount++};this.setMessage=function(a){if(typeof a!="undefined")document.getElementById(this.id+"_msg").innerHTML=a};this.addMenu=function(a,d,c,h){this.addSeparatorAsNeed();var i=document.createElement("div");i.className="toolbar-item";var o=this.id+this.itemCount+"_menu";i.id=o;i.tabIndex=0;i.title=h||a;i.onmouseout=n;i.onmouseover=l;this.items_div.appendChild(i);
d==null?(i.innerHTML=f(null,c)+a+"&nbsp;"+f(null,"action-downarrow"),i.onclick=function(a){e(a)}):(h=document.createElement("span"),h.innerHTML=f(d,c)+a,j(h,d),a=document.createElement("span"),a.innerHTML=f(d,"action-downarrow"),a.onclick=function(a){e(a)},i.appendChild(h),i.appendChild(a));i.onblur=function(a){a:{for(var b=g.event.getTarget(a);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;a=b.lastElementChild||b.lastChild;if(null==a||a.tagName.toLowerCase()!="table")alert("menu is null then return and target is "+
b);else if(a.style.visibility!=""&&a.style.visibility!="hidden"){for(b=0;b<a.rows.length;b++)if(a.rows[b].cells[0].className=="toolbar-menuitem-transfer")break a;a.style.visibility="hidden"}}};d=new k(o,i);this.itemCount++;return d}}}g.alert=function(a){alert(a)};g.uitheme="default";g.extend({"ui.toolbar":function(a,c,d){return new p(a,c,d)}});g.extend({"ui.gridbar":function(a,c){function d(a,e,d,c,f){for(var g=[],n=0;n<f.length;n++)g[n]=f[n].addMenu(a,e,d,c);this.addItem=function(a,b,e,d){for(var c=
0;c<g.length;c++)g[c].addItem(a,b,e,d)}}this.divIds=a;this.pageId=null;this.title=c;this.toolbars=[];for(var f=0;f<a.length;f++)this.toolbars[f]=g.ui.toolbar(a[f],c),this.toolbars[f].setSeparator(""),document.getElementById(a[f]).className="gridbar",document.getElementById(a[f]+"_items").className="gridbar-items";this.pageId=function(a){this.pageId=a;return this};this.addItem=function(a,e,d,c){for(var f=0;f<this.toolbars.length;f++)this.toolbars[f].addItem(a,e,d,c)};this.addBack=function(a){for(var e=
0;e<this.toolbars.length;e++)this.toolbars[e].addBack(a)};this.addBackOrClose=function(){for(var a=0;a<this.toolbars.length;a++)this.toolbars[a].addBackOrClose()};this.addBlankItem=function(a,e,d,c){for(var f=0;f<this.toolbars.length;f++)this.toolbars[f].addBlankItem(a,e,d,c)};this.addPage=function(d,e,c){this.myPage=d;for(var f=0;f<this.toolbars.length;f++)pageDiv=this.toolbars[f].appendDiv(a[f]+"_page","girdbar-pgbar"),g.ui.pagebar(d,pageDiv,e,c);return this};this.addEntityAction=function(a,e){return new g.entityaction(a,
e)};this.addPrint=function(a){for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].addPrint(a)};this.addMenu=function(a,e,c,f){return new d(a,e,c,f,this.toolbars)}}});g.extend({"ui.pagebar":function(a,c,d,f){if(a.total!=0){d?d.length==0&&(d=[a.pageSize]):d=[10,20,30,50,70,100,200,500,1E3];f||(f={first:"\u00ab First",previous:"\u2039 Previous",next:"Next \u203a",last:"Last \u00bb",no:"No:",size:"Size:",change:"Click me to change page size",pagesize:"Page Size"});var g=a.maxPageNo;addAnchor=function(e,
d){var b=document.createElement("a");b.setAttribute("href","#");b.innerHTML=e;b.style.padding="0px 2px 0px 2px";c.appendChild(b);jQuery(b).click(function(){a.goPage(d)})};a.pageNo>1&&(addAnchor(f.first,1),addAnchor(f.previous,a.pageNo-1));var e=document.createElement("span");e.innerHTML="<strong>"+a.startNo+"</strong> - <strong>"+a.endNo+"</strong> of <strong>"+a.total+"</strong>";e.style.padding="0px 2px 0px 2px";c.appendChild(e);e=jQuery(e);e.attr("title",f.change);e.mouseover(function(){this.className=
"pgbar-label"});e.mouseout(function(){this.className=""});e.click(function(){this.parentNode.style.marginTop="0px";this.nextSibling.style.display="";this.style.display="none"});e=document.createElement("span");e.style.display="none";if(d&&d.length>0){var k=document.createElement("select");k.id=c.id+"_select";e.appendChild(k);k.className="pgbar-selbox";k.title=f.pagesize||"Page Size";for(var i=0,h=0;h<d.length;h++)d[h]==a.pageSize&&(i=h),k.options.add(new Option(f.size+d[h],d[h]));k.selectedIndex=
i}d=document.createElement("input");d.className="pgbar-input";e.appendChild(d);d=jQuery(d);d.attr("value",a.pageNo+"/"+g);d.attr("id",c.id+"_input");d.attr("title",a.startNo+" - "+a.endNo+" of "+a.total);d.focus(function(){this.value=""});d.blur(function(){if(!this.value)this.value=a.pageNo+"/"+g});d=document.createElement("input");d.setAttribute("type","button");d.setAttribute("name","gogo");d.value="Go";d.className="pgbar-go";e.appendChild(d);var l=function(){var e=document.getElementById(c.id+
"_input").value,d=e.indexOf("/"+a.maxPageNo);-1!=d&&(e=e.substring(0,d));a.goPage(e,document.getElementById(c.id+"_select").value)};jQuery(d).click(function(){l()});c.appendChild(e);jQuery(e).keypress(function(a){if(!a)a=window.event;if(a&&a.keyCode&&a.keyCode==13)return l(),!1});a.pageNo<a.maxPageNo&&(addAnchor(f.next,a.pageNo+1),addAnchor(f.last,a.maxPageNo))}}});g.extend({"ui.grid":{overSortTableHeader:function(){this.style.color="white";this.style.backgroundColor="green"},outSortTableHeader:function(){this.style.borderColor=
"";this.style.color="";this.style.backgroundColor=""},mouseOverGrid:function(){if(typeof this.className!="undefined"){var a=this.className;selectIndex=a.indexOf("griddata-selected");if(-1==selectIndex)overIndex=a.indexOf("griddata-over"),this.className=-1==overIndex?a+" griddata-over":a.substring(0,overIndex)}},onRowChange:function(a){var a=g.event.getTarget(a),c=!0;if(null!=a&&a.tagName.toLowerCase()=="td"){for(a=a.parentNode.firstChild;a.tagName==null||a.tagName.toLowerCase()!="td";)a=a.nextSibling;
for(a=a.firstChild;typeof a.tagName=="undefined"||a.tagName.toLowerCase()!="input";)if(a=a.nextSibling,a==null)return;a.checked=!a.checked}else a.type=="checkbox"||a.type=="radio"||(c=!1);if(null!=a&&c){if(typeof a.onchange=="function")a.onchange();if(a.type!="radio"&&(c=a.parentNode.parentNode,typeof c.className!="undefined")){var d=c.className.indexOf("griddata-selected");if(a.checked)-1==d&&(c.className+=" griddata-selected");else if(-1!=d)c.className=c.className.substring(0,d)}}},sort:function(a,
c){if(null==a)g.alert("\u65e0\u6cd5\u627e\u5230\u5143\u7d20\u5bf9\u5e94\u7684\u6392\u5e8f\u8868\u683c\uff01");else{var d=null,d=c.className=="gridhead-sortable"?typeof c.asc!="undefined"?c.asc:c.id+" asc":c.className=="gridhead-asc"?typeof c.desc!="undefined"?c.desc:c.id.replace(/\,/g," desc,")+" desc":"";a.goPage(1,null,d)}},init:function(a,c){var d=document.getElementById(a).tHead,f,j,e,k,i,h,l;if(d&&d.rows.length!=0){f=c.orderby;j=function(){g.ui.grid.sort(c,this)};for(k=0;k<d.rows.length;k++){i=
d.rows[k];for(e=0;e<i.cells.length;e++)if(h=i.cells[e],h.className=="gridhead-sortable"&&null!=h.id){h.onclick=j;h.onmouseover=g.ui.grid.overSortTableHeader;h.onmouseout=g.ui.grid.outSortTableHeader;h.title="\u70b9\u51fb\u6309 ["+h.innerHTML+"] \u6392\u5e8f";l=h.id.replace(/\,/g," desc,")+" desc";if(typeof h.desc!="undefined")l=h.desc;if(f.indexOf(l)!=-1)h.className="gridhead-desc",h.innerHTML+='<span class="gridhead-icon action-sort-desc"></span>';else{l=h.id+" asc";if(typeof h.asc!="undefined")l=
h.asc;if(f==l)h.className="gridhead-asc",h.innerHTML+='<span class="gridhead-icon action-sort-asc"></span>'}}}if(d=document.getElementById(a+"_data"))for(k=0;k<d.rows.length;k++)f=d.rows[k],j=(j=f.className)?" "+j:"",f.className=k%2==1?"griddata-odd"+j:"griddata-even"+j,f.onclick=g.ui.grid.onRowChange,f.onmouseover=g.ui.grid.mouseOverGrid,f.onmouseout=g.ui.grid.mouseOverGrid}},fillEmpty:function(a,c,d,f){a=document.getElementById(a);c-=d;c>7&&(c=7);c*=16;if(d==0)d=document.createElement("div"),d.innerHTML=
f||"No result matched your search.",d.style.paddingTop=c/2-16+"px",a.appendChild(d);a.style.height=c+"px"}}});g.extend({entityaction:function(a,c){function d(a,d){var c=a.lastIndexOf("!"),f=a.lastIndexOf("."),g=a,j="";-1==c&&(c=f);-1!=c&&(g=a.substring(0,c));-1!=f&&(j=a.substring(f));return g+"!"+d+j}this.entity=a;this.page=c;this.formid="form_"+g.randomInt();var f=this;this.getForm=function(){return this.page.getForm()};this.addParam=function(a,d){g.form.addInput(this.getForm(),a,d)};if(null!=this.page.target&&
""!=this.page.target){var j=this.getForm();if(null!=j)j.target=this.page.target}this.beforeSubmmitId=function(e){var c=g.input.getCheckBoxValues(a+".id");if(c==null||c=="")return g.alert("\u4f60\u6ca1\u6709\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55\uff01"),!1;c=this.getForm();c.action=d(this.page.actionurl,e);this.page.paramstr&&(g.form.addHiddens(c,this.page.paramstr),g.form.addParamsInput(c,this.page.paramstr));return!0};this.submitIdAction=function(a,d,c,f){this.beforeSubmmitId(a)&&(!(null!=
c&&""!=c)||confirm(c))&&g.form.submitId(this.getForm(),this.entity+".id",d,null,null,f)};this.remove=function(a){a=a||"\u786e\u8ba4\u5220\u9664?";return new m("remove",function(){f.submitIdAction("remove",!0,a)})};this.add=function(){return new m("add",function(){var a=f.getForm();""!=f.page.paramstr&&g.form.addHiddens(a,f.page.paramstr);g.form.addInput(a,f.entity+".id","");""!=f.page.paramstr&&g.form.addParamsInput(a,f.page.paramstr);g.form.submit(a,d(f.page.actionurl,"edit"))})};this.info=function(){return new m("info",
function(){f.submitIdAction("info",!1)})};this.edit=function(){return new m("edit",function(){f.submitIdAction("edit",!1)})};this.single=function(a,d,c){return new m(a,function(){var h=f.getForm();null!=c&&g.form.addHiddens(h,c);f.submitIdAction(a,!1,d)})};this.multi=function(a,d,c,h){return new m(a,function(){try{var l=f.getForm();null!=c&&g.form.addHiddens(l,c);f.submitIdAction(a,!0,d,h)}catch(j){g.alert(j)}})};this.method=function(a,c,i,h){return new m(a,function(){var j=f.getForm();if(!(null!=
c&&""!=c)||confirm(c))null!=i&&g.form.addHiddens(j,i),""!=f.page.paramstr&&(g.form.addHiddens(j,f.page.paramstr),g.form.addParamsInput(j,f.page.paramstr)),g.form.submit(j,d(f.page.actionurl,a),null,null,h)})};this.exportData=function(a,d,c){d=d||"xls";a=a||"";c=c||"";c.indexOf("&")!=0&&(c="&"+c);return f.method("export",null,"&format="+d+"&properties="+a+c,!1)}}});g.extend({"ui.module":{moduleClick:function(a){a=document.getElementById(a);a.className=a.className=="module collapsed"?"module expanded":
"module collapsed"}}});g.extend({"ui.load":function(a,c){var d=g.getContextPath();a=="validity"?(jQuery.struts2_jquery.requireCss("/static/themes/"+g.uitheme+"/jquery.validity.css",d),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery.validity-1.1.1.js",null,d),jQuery.struts2_jquery.scriptCache["/static/scripts/i18n/zh_CN/jquery.validity.js"]&&c?c():jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery.validity.js",c,d)):a=="tabletree"?(jQuery.struts2_jquery.requireCss("/static/themes/"+
g.uitheme+"/beangle-ui-tabletree.css",d),jQuery.struts2_jquery.require("/static/scripts/beangle/beangle-ui-tabletree.js",c,d)):a=="colorbox"?(jQuery.struts2_jquery.requireCss("/static/themes/"+g.uitheme+"/colorbox.css",d),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-colorbox-1.3.17.1.min.js",c,d)):a=="jquery.pstrength"&&(jQuery.struts2_jquery.requireCss("/static/themes/"+g.uitheme+"/jquery-pstrength.css",d),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-pstrength.2.1.js",
c,d),jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery-pstrength.js",c,d))}})})(beangle);
