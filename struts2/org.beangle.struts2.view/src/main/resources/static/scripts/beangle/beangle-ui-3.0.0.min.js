(function(e){function n(a,c,b){this.name=a;this.func=c;this.objectCount=null==b?0:b}function p(a,c,b){function f(d,b){var a="action-default";if(null!=b)if(b.indexOf(".")>-1)return b.charAt(0)!="/"&&(b=o+b),'<img class="toolbar-img" src="'+b+'"/>';else a=b;if(null==b&&null!=d){if(typeof d=="object")d=d.name;typeof d=="string"&&(d.indexOf("add")==0||d.indexOf("batchAdd")==0||d.indexOf("new")==0?a="action-new":d.indexOf("remove")==0||d.indexOf("delete")==0?a="action-edit-delete":d.indexOf("update")==
0||d.indexOf("edit")==0||d.indexOf("batchEdit")==0?a="action-update":d.indexOf("export")==0?a="action-excel":d.indexOf("copy")==0?a="action-edit-copy":d.indexOf("print")==0?a="action-print":d.indexOf("refresh")==0?a="action-refresh":d.indexOf("close")==0?a="action-close":d.indexOf("save")==0?a="action-save":d.indexOf("download")==0&&(a="action-download"))}return'<span class="toolbar-icon '+a+'" ></span>'}function h(d,a){if(null==a)e.alert("action should not be null");else if(typeof a=="function")d.onclick=
a;else{if(typeof a=="string")a.indexOf("(")!=-1?d.onclick=function(){eval(a)}:a.indexOf(".action")!=-1?d.onclick=function(){Go(a)}:e.alert("unsuported action description:"+a);if(typeof a=="object")d.onclick=a.func}}function g(d){for(d=e.event.getTarget(d);d&&d.tagName.toLowerCase()!="div";)d=d.parentNode;var a=d.lastElementChild||d.lastChild;null==a?alert("menu is null then return and target is "+d):a.style.visibility!=""&&a.style.visibility!="hidden"?(a.style.visibility="hidden",d.className="toolbar-item-transfer"):
(a.style.visibility="visible",d.className="toolbar-item-selected")}function k(d,a){var b=document.createElement("table");b.className="toolbar-menu";b.id=d+"Table";var c=document.createElement("tbody");b.appendChild(c);if(jQuery("#"+d).find("span").length>0)b.onclick=function(d){g(d)};a.appendChild(b);this.table=b;this.addItem=function(d,a,b,c){var g=document.createElement("td");g.innerHTML=f(a,b)+d;g.onmouseout=j;g.onmouseover=i;g.title=c||d;h(g,a);g.className="toolbar-menuitem";g.width="100%";d=
document.createElement("tr");d.appendChild(g);this.table.tBodies.length==0&&this.table.appendChild(document.createElement("tbody"));this.table.tBodies[0].appendChild(d)}}function j(d){for(d=e.event.getTarget(d);d&&d.tagName.toLowerCase()!="td";)d=d.parentNode;if(d)d.className="toolbar-menuitem"}function i(d){for(d=e.event.getTarget(d);d&&d.tagName.toLowerCase()!="td";)d=d.parentNode;if(d)d.className="toolbar-menuitem-transfer"}function l(d){for(d=e.event.getTarget(d);d&&d.tagName.toLowerCase()!="div";)d=
d.parentNode;d&&jQuery(d).removeClass("toolbar-item").addClass("toolbar-item-transfer")}function m(d){for(d=e.event.getTarget(d);d&&d.tagName.toLowerCase()!="div";)d=d.parentNode;d&&jQuery(d).removeClass("toolbar-item-transfer").addClass("toolbar-item")}this.itemCount=0;this.bar=document.getElementById(a);if(null!=this.bar){this.id=a;this.separator="&nbsp;";this.bar.className="toolbar notprint";var o=self.location.pathname.substring(0,self.location.pathname.substring(1).indexOf("/")+1)+"/static/themes/"+
e.uitheme+"/icons/16x16/actions/";this.setTitle=function(d,a){if(d)a==null&&(a="action-info"),this.title_div.innerHTML=f(null,a)+"<strong>"+d+"</strong>"};this.setSeparator=function(d){this.separator=d};this.init=function(d,a){var b=document.createElement("div");b.className="toolbar-title";this.bar.appendChild(b);this.title_div=b;this.setTitle(d,a);b=document.createElement("div");b.className="toolbar-items";b.id=this.id+"_items";this.items_div=b;this.bar.appendChild(b);b=document.createElement("div");
b.className="toolbar-msg";b.style.display="none";b.id=this.id+"_msg";this.bar.appendChild(b)};this.init(c,b);this.addHr=function(){hrdiv=this.appendDiv(null,"toolbar-line");hrdiv.innerHTML='<img height="1" width="100%" align="top" src="'+o+'keyline.png" />'};this.addBack=function(d){null==d?this.addItem("\u8fd4\u56de",function(){history.back(-1)},"action-backward"):this.addItem(d,function(){history.back(-1)},"action-backward")};this.addHelp=function(d){this.addItem("\u5e2e\u52a9",function(){null==
d?e.alert("\u65bd\u5de5\u4e2d.."):window.open("help.action?helpId="+d)},"action-help-contents")};this.addPrint=function(d){null==d?this.addItem("\u6253\u5370","print()"):this.addItem(d,"print()")};this.addClose=function(d){if(""==d||null==d)d="\u5173\u95ed";this.addItem(d,"window.close()","action-close")};this.addItem=function(d,a,b,g,c){this.addSeparatorAsNeed();var e=document.createElement("div");e.innerHTML=f(a,b)+d;e.onmouseout=m;e.onmouseover=l;h(e,a);if(!c&&typeof a=="object")c=a.objectCount;
c||(c="ge0");e.className="toolbar-item toolbar-item-"+c+(c!="ge0"?" toolbar-item-disabled":"");e.title=g==null?d:g;this.items_div.appendChild(e);this.itemCount++;return e};this.addDiv=function(d){var a=document.createElement("div");if(d)a.className=d;this.items_div.appendChild(a);return a};this.appendDiv=function(a,b){var g=document.createElement("div");a&&g.setAttribute("id",a);if(b)g.className=b;document.getElementById(this.id).appendChild(g);return g};this.addSeparator=function(){if(this.separator)this.addDiv("toolbar-separator").innerHTML=
this.separator};this.addSeparatorAsNeed=function(){this.itemCount!=0&&this.addSeparator()};this.addBackOrClose=function(a,b){parent.location==self.location&&(window.history.length<=1||window.history.length==null)?this.addClose(null==b?"\u5173\u95ed":b):this.addBack(null==a?"\u540e\u9000":a)};this.addBlankItem=function(){this.addDiv("toolbar-group-separator").innerHTML="&nbsp;";this.itemCount++};this.setMessage=function(a){if(typeof a!="undefined")document.getElementById(this.id+"_msg").innerHTML=
a};this.addMenu=function(a,b,c,i){this.addSeparatorAsNeed();var j=document.createElement("div");j.className="toolbar-item";var o=this.id+this.itemCount+"_menu";j.id=o;j.tabIndex=0;j.title=i||a;j.onmouseout=m;j.onmouseover=l;this.items_div.appendChild(j);b==null?(j.innerHTML=f(null,c)+a+"&nbsp;"+f(null,"action-downarrow"),j.onclick=function(a){g(a)}):(i=document.createElement("span"),i.innerHTML=f(b,c)+a,h(i,b),a=document.createElement("span"),a.innerHTML=f(b,"action-downarrow"),a.onclick=function(a){g(a)},
j.appendChild(i),j.appendChild(a));j.onblur=function(a){a:{for(var b=e.event.getTarget(a);b&&b.tagName.toLowerCase()!="div";)b=b.parentNode;a=b.lastElementChild||b.lastChild;if(null==a||a.tagName.toLowerCase()!="table")alert("menu is null then return and target is "+b);else if(a.style.visibility!=""&&a.style.visibility!="hidden"){for(b=0;b<a.rows.length;b++)if(a.rows[b].cells[0].className=="toolbar-menuitem-transfer")break a;a.style.visibility="hidden"}}};b=new k(o,j);this.itemCount++;return b}}}
e.alert=function(a){alert(a)};e.uitheme="default";e.extend({"ui.toolbar":function(a,c,b){return new p(a,c,b)}});e.extend({"ui.gridbar":function(a,c){function b(a,b,c,e,f){for(var l=[],m=0;m<f.length;m++)l[m]=f[m].addMenu(a,b,c,e);this.addItem=function(a,b,c,g){for(var e=0;e<l.length;e++)l[e].addItem(a,b,c,g)}}this.divIds=a;this.pageId=null;this.title=c;this.toolbars=[];for(var f=0;f<a.length;f++)this.toolbars[f]=e.ui.toolbar(a[f],c),this.toolbars[f].setSeparator(""),document.getElementById(a[f]).className=
"gridbar",document.getElementById(a[f]+"_items").className="gridbar-items";this.pageId=function(a){this.pageId=a;return this};this.addItem=function(a,b,c,e){for(var f=0;f<this.toolbars.length;f++)this.toolbars[f].addItem(a,b,c,e)};this.addBack=function(a){for(var b=0;b<this.toolbars.length;b++)this.toolbars[b].addBack(a)};this.addBackOrClose=function(){for(var a=0;a<this.toolbars.length;a++)this.toolbars[a].addBackOrClose()};this.addBlankItem=function(a,b,c,e){for(var f=0;f<this.toolbars.length;f++)this.toolbars[f].addBlankItem(a,
b,c,e)};this.addPage=function(b,c,f){this.myPage=b;for(var j=0;j<this.toolbars.length;j++)pageDiv=this.toolbars[j].appendDiv(a[j]+"_page","girdbar-pgbar"),e.ui.pagebar(b,pageDiv,c,f);return this};this.addEntityAction=function(a,b){return new e.entityaction(a,b)};this.addPrint=function(a){for(var b=0;b<this.toolbars.length;b++)this.toolbars[b].addPrint(a)};this.addMenu=function(a,c,e,f){return new b(a,c,e,f,this.toolbars)}}});e.extend({"ui.pagebar":function(a,c,b,e){if(a.total!=0){b?b.length==0&&(b=
[a.pageSize]):b=[10,20,30,50,70,100,200,500,1E3];e||(e={first:"\u00ab First",previous:"\u2039 Previous",next:"Next \u203a",last:"Last \u00bb",no:"No:",size:"Size:",change:"Click me to change page size",pagesize:"Page Size"});var h=a.maxPageNo;addAnchor=function(b,e){var d=document.createElement("a");d.setAttribute("href","#");d.innerHTML=b;d.style.padding="0px 2px 0px 2px";c.appendChild(d);jQuery(d).click(function(){a.goPage(e)})};a.pageNo>1&&(addAnchor(e.first,1),addAnchor(e.previous,a.pageNo-1));
var g=document.createElement("span");g.innerHTML="<strong>"+a.startNo+"</strong> - <strong>"+a.endNo+"</strong> of <strong>"+a.total+"</strong>";g.style.padding="0px 2px 0px 2px";c.appendChild(g);g=jQuery(g);g.attr("title",e.change);g.mouseover(function(){this.className="pgbar-label"});g.mouseout(function(){this.className=""});g.click(function(){this.parentNode.style.marginTop="0px";this.nextSibling.style.display="";this.style.display="none"});g=document.createElement("span");g.style.display="none";
if(b&&b.length>0){var k=document.createElement("select");k.id=c.id+"_select";g.appendChild(k);k.className="pgbar-selbox";k.title=e.pagesize||"Page Size";for(var j=0,i=0;i<b.length;i++)b[i]==a.pageSize&&(j=i),k.options.add(new Option(e.size+b[i],b[i]));k.selectedIndex=j}b=document.createElement("input");b.className="pgbar-input";g.appendChild(b);b=jQuery(b);b.attr("value",a.pageNo+"/"+h);b.attr("id",c.id+"_input");b.attr("title",a.startNo+" - "+a.endNo+" of "+a.total);b.focus(function(){this.value=
""});b.blur(function(){if(!this.value)this.value=a.pageNo+"/"+h});b=document.createElement("input");b.setAttribute("type","button");b.setAttribute("name","gogo");b.value="Go";b.className="pgbar-go";g.appendChild(b);var l=function(){var b=document.getElementById(c.id+"_input").value,e=b.indexOf("/"+a.maxPageNo);-1!=e&&(b=b.substring(0,e));a.goPage(b,document.getElementById(c.id+"_select").value)};jQuery(b).click(function(){l()});c.appendChild(g);jQuery(g).keypress(function(a){if(!a)a=window.event;
if(a&&a.keyCode&&a.keyCode==13)return l(),!1});a.pageNo<a.maxPageNo&&(addAnchor(e.next,a.pageNo+1),addAnchor(e.last,a.maxPageNo))}}});e.extend({"ui.grid":{enableSingleRowSelect:!1,enableDynaBar:!1,overSortTableHeader:function(){this.style.color="white";this.style.backgroundColor="green"},outSortTableHeader:function(){this.style.borderColor="";this.style.color="";this.style.backgroundColor=""},mouseOverGrid:function(){if(typeof this.className!="undefined"){var a=this.className;selectIndex=a.indexOf("griddata-selected");
if(-1==selectIndex)overIndex=a.indexOf("griddata-over"),this.className=-1==overIndex?a+" griddata-over":a.substring(0,overIndex)}},setGridMessage:function(a,c){var b=document.getElementById(a+"_bar1_msg"),e=document.getElementById(a+"_bar2_msg");if(b)b.style.display=c?"":"none",b.innerHTML=c?c:"";if(e)e.style.display=c?"":"none",e.innerHTML=c?c:""},toggleAll:function(a){for(var c=e.event.getTarget(a),a=c;a.tagName!=null&&a.tagName.toLowerCase()!="table";)if(a=a.parentNode,null==a)break;if(null!=a){var b=
0;jQuery("#"+a.id+" .gridselect").each(function(){c.checked?(jQuery(this).find("input").attr("checked","checked"),jQuery(this).parent("tr").addClass("griddata-selected"),b++):jQuery(this).find("input").is(":checked")&&(jQuery(this).find("input").removeAttr("checked"),jQuery(this).parent("tr").removeClass("griddata-selected"))});e.ui.grid.notifyGridbar(a.id,b)}},notifyGridbar:function(a,c){var b=function(){c>=2?jQuery(this).hasClass("toolbar-item-e1")?jQuery(this).addClass("toolbar-item-disabled"):
jQuery(this).removeClass("toolbar-item-disabled"):c==1?jQuery(this).hasClass("toolbar-item-ge2")?jQuery(this).addClass("toolbar-item-disabled"):jQuery(this).removeClass("toolbar-item-disabled"):jQuery(this).hasClass("toolbar-item-ge0")?jQuery(this).removeClass("toolbar-item-disabled"):jQuery(this).addClass("toolbar-item-disabled")};e.ui.grid.enableDynaBar&&(jQuery("#"+a+"_bar1_items .toolbar-item").each(b),jQuery("#"+a+"_bar2_items .toolbar-item").each(b));c>1?e.ui.grid.setGridMessage(a,"\u5df2\u9009\u62e9 <b>"+
c+"</b> \u6761"):e.ui.grid.setGridMessage(a,"")},toggleRow:function(a){for(var c=e.event.getTarget(a),b=c;b.tagName!=null&&b.tagName.toLowerCase()!="table";)if(b=b.parentNode,null==b)break;var f=!0,h=null,g=!1;if(null!=c&&c.tagName.toLowerCase()=="td"){for(h=c.parentNode.firstChild;h.tagName==null||h.tagName.toLowerCase()!="td";)h=h.nextSibling;g=c==h;for(c=h.firstChild;typeof c.tagName=="undefined"||c.tagName.toLowerCase()!="input";)if(c=c.nextSibling,c==null)return;c.checked=!c.checked}else c.type==
"checkbox"||c.type=="radio"?(h=c.parentNode,g=!0):f=!1;if(!(null==c||null==h||null==b||!f))if(f=h.parentNode,typeof f.className!="undefined"){c.checked?jQuery(f).removeClass("griddata-over").addClass("griddata-selected"):jQuery(f).removeClass("griddata-selected").addClass("griddata-over");var k=0;if(c.type=="radio")c.checked&&(k=1);else{var j=!e.ui.grid.enableSingleRowSelect||g||a.ctrlKey;jQuery("#"+b.id+" .gridselect").each(function(){jQuery(this).find("input").is(":checked")&&(h!=this&&!j?(jQuery(this).find("input").removeAttr("checked"),
jQuery(this).parent("tr").removeClass("griddata-selected")):k++)});j||jQuery("#"+b.id+" .gridselect-top").each(function(){jQuery(this).find("input").removeAttr("checked")})}e.ui.grid.notifyGridbar(b.id,k);if(typeof c.onchange=="function")c.onchange()}},sort:function(a,c){if(null==a)e.alert("\u65e0\u6cd5\u627e\u5230\u5143\u7d20\u5bf9\u5e94\u7684\u6392\u5e8f\u8868\u683c\uff01");else{var b=null,b=c.className=="gridhead-sortable"?typeof c.asc!="undefined"?c.asc:c.id+" asc":c.className=="gridhead-asc"?
typeof c.desc!="undefined"?c.desc:c.id.replace(/\,/g," desc,")+" desc":"";a.goPage(1,null,b)}},init:function(a,c){var b=document.getElementById(a).tHead,f,h,g,k,j,i,l;if(b&&b.rows.length!=0){f=c.orderby;h=function(){e.ui.grid.sort(c,this)};for(k=0;k<b.rows.length;k++){j=b.rows[k];for(g=0;g<j.cells.length;g++)if(i=j.cells[g],i.className=="gridhead-sortable"&&null!=i.id){i.onclick=h;i.onmouseover=e.ui.grid.overSortTableHeader;i.onmouseout=e.ui.grid.outSortTableHeader;i.title="\u70b9\u51fb\u6309 ["+
i.innerHTML+"] \u6392\u5e8f";l=i.id.replace(/\,/g," desc,")+" desc";if(typeof i.desc!="undefined")l=i.desc;if(f.indexOf(l)!=-1)i.className="gridhead-desc",i.innerHTML+='<span class="gridhead-icon action-sort-desc"></span>';else{l=i.id+" asc";if(typeof i.asc!="undefined")l=i.asc;if(f==l)i.className="gridhead-asc",i.innerHTML+='<span class="gridhead-icon action-sort-asc"></span>'}}}if(b=document.getElementById(a+"_data"))for(k=0;k<b.rows.length;k++)f=b.rows[k],h=(h=f.className)?" "+h:"",f.className=
k%2==1?"griddata-odd"+h:"griddata-even"+h,f.onclick=e.ui.grid.toggleRow,f.onmouseover=e.ui.grid.mouseOverGrid,f.onmouseout=e.ui.grid.mouseOverGrid}},fillEmpty:function(a,c,b,e){a=document.getElementById(a);c-=b;c>7&&(c=7);c*=16;if(b==0)b=document.createElement("div"),b.innerHTML=e||"No result matched your search.",b.style.paddingTop=c/2-16+"px",a.appendChild(b);a.style.height=c+"px"}}});e.extend({entityaction:function(a,c){function b(a,b){var c=a.lastIndexOf("!"),e=a.lastIndexOf("."),f=a,h="";-1==
c&&(c=e);-1!=c&&(f=a.substring(0,c));-1!=e&&(h=a.substring(e));return f+"!"+b+h}this.entity=a;this.page=c;this.formid="form_"+e.randomInt();var f=this;this.getForm=function(){return this.page.getForm()};this.addParam=function(a,b){e.form.addInput(this.getForm(),a,b)};if(null!=this.page.target&&""!=this.page.target){var h=this.getForm();if(null!=h)h.target=this.page.target}this.beforeSubmmitId=function(c){var f=e.input.getCheckBoxValues(a+".id");if(f==null||f=="")return e.alert("\u4f60\u6ca1\u6709\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55\uff01"),
!1;f=this.getForm();f.action=b(this.page.actionurl,c);this.page.paramstr&&(e.form.addHiddens(f,this.page.paramstr),e.form.addParamsInput(f,this.page.paramstr));return!0};this.submitIdAction=function(a,b,c,f){this.beforeSubmmitId(a)&&(!(null!=c&&""!=c)||confirm(c))&&e.form.submitId(this.getForm(),this.entity+".id",b,null,null,f)};this.remove=function(a){a=a||"\u786e\u8ba4\u5220\u9664?";return new n("remove",function(){f.submitIdAction("remove",!0,a)},e.ui.grid.enableDynaBar?"ge1":"ge0")};this.add=
function(){return new n("add",function(){var a=f.getForm();""!=f.page.paramstr&&e.form.addHiddens(a,f.page.paramstr);e.form.addInput(a,f.entity+".id","");""!=f.page.paramstr&&e.form.addParamsInput(a,f.page.paramstr);e.form.submit(a,b(f.page.actionurl,"edit"))})};this.info=function(){return new n("info",function(){f.submitIdAction("info",!1)},e.ui.grid.enableDynaBar?"e1":"ge0")};this.edit=function(){return new n("edit",function(){f.submitIdAction("edit",!1)},e.ui.grid.enableDynaBar?"e1":"ge0")};this.single=
function(a,b,c){return new n(a,function(){var i=f.getForm();null!=c&&e.form.addHiddens(i,c);f.submitIdAction(a,!1,b)},e.ui.grid.enableDynaBar?"e1":"ge0")};this.multi=function(a,b,c,i){return new n(a,function(){try{var h=f.getForm();null!=c&&e.form.addHiddens(h,c);f.submitIdAction(a,!0,b,i)}catch(m){e.alert(m)}},e.ui.grid.enableDynaBar?"ge1":"ge0")};this.method=function(a,c,j,i){return new n(a,function(){var h=f.getForm();if(!(null!=c&&""!=c)||confirm(c))null!=j&&e.form.addHiddens(h,j),""!=f.page.paramstr&&
(e.form.addHiddens(h,f.page.paramstr),e.form.addParamsInput(h,f.page.paramstr)),e.form.submit(h,b(f.page.actionurl,a),null,null,i)})};this.exportData=function(a,b,c){b=b||"xls";a=a||"";c=c||"";c.indexOf("&")!=0&&(c="&"+c);return f.method("export",null,"&format="+b+"&properties="+a+c,!1)}}});e.extend({"ui.module":{moduleClick:function(a){a=document.getElementById(a);a.className=a.className=="module collapsed"?"module expanded":"module collapsed"}}});e.extend({"ui.load":function(a,c){var b=e.getContextPath();
a=="validity"?(jQuery.struts2_jquery.requireCss("/static/themes/"+e.uitheme+"/jquery.validity.css",b),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery.validity-1.1.1.js",null,b),jQuery.struts2_jquery.scriptCache["/static/scripts/i18n/zh_CN/jquery.validity.js"]&&c?c():jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery.validity.js",c,b)):a=="tabletree"?(jQuery.struts2_jquery.requireCss("/static/themes/"+e.uitheme+"/beangle-ui-tabletree.css",b),jQuery.struts2_jquery.require("/static/scripts/beangle/beangle-ui-tabletree.js",
c,b)):a=="colorbox"?(jQuery.struts2_jquery.requireCss("/static/themes/"+e.uitheme+"/colorbox.css",b),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-colorbox-1.3.17.1.min.js",c,b)):a=="jquery.pstrength"&&(jQuery.struts2_jquery.requireCss("/static/themes/"+e.uitheme+"/jquery-pstrength.css",b),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-pstrength.2.1.js",c,b),jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery-pstrength.js",c,b))}})})(beangle);
