!function(bg,undefined){function NamedFunction(name,func,objectCount){this.name=name,this.func=func,this.objectCount=null==objectCount?"ge0":objectCount}function ToolBar(divId,title,imageName){function genIconElement(action,cssClassOrIconPath){var cssClass="action-default";if(null!=cssClassOrIconPath){if(cssClassOrIconPath.indexOf(".")>-1)return"/"!=cssClassOrIconPath.charAt(0)&&(cssClassOrIconPath=imagePath+cssClassOrIconPath),'<img class="toolbar-img" src="'+cssClassOrIconPath+'"/>';cssClass=cssClassOrIconPath}return null==cssClassOrIconPath&&null!=action&&("object"==typeof action&&(action=action.name),"string"==typeof action&&(0==action.indexOf("add")||0==action.indexOf("batchAdd")||0==action.indexOf("new")?cssClass="action-new":0==action.indexOf("remove")||0==action.indexOf("delete")?cssClass="action-edit-delete":0==action.indexOf("update")||0==action.indexOf("edit")||0==action.indexOf("batchEdit")?cssClass="action-update":0==action.indexOf("export")?cssClass="action-excel":0==action.indexOf("copy")?cssClass="action-edit-copy":0==action.indexOf("print")?cssClass="action-print":0==action.indexOf("refresh")?cssClass="action-refresh":0==action.indexOf("close")?cssClass="action-close":0==action.indexOf("save")?cssClass="action-save":0==action.indexOf("download")&&(cssClass="action-download"))),'<span class="toolbar-icon '+cssClass+'" ></span>'}function setAction(item,action){return null==action?(bg.alert("action should not be null"),void 0):"function"==typeof action?(item.onclick=action,void 0):("string"==typeof action&&(-1!=action.indexOf("(")?item.onclick=function(){eval(action)}:-1!=action.indexOf(".action")?item.onclick=function(){Go(action)}:bg.alert("unsuported action description:"+action)),"object"==typeof action?(item.onclick=action.func,void 0):void 0)}function hiddenMenu(event){for(var div=bg.event.getTarget(event);div&&"div"!=div.tagName.toLowerCase();)div=div.parentNode;var menu=div.lastElementChild||div.lastChild;if(null==menu||"table"!=menu.tagName.toLowerCase())return alert("menu is null then return and target is "+div),void 0;if(""!=menu.style.visibility&&"hidden"!=menu.style.visibility){for(var i=0;i<menu.rows.length;i++)if("toolbar-menuitem-transfer"==menu.rows[i].cells[0].className)return;menu.style.visibility="hidden"}}function displayMenu(event){for(var div=bg.event.getTarget(event);div&&"div"!=div.tagName.toLowerCase();)div=div.parentNode;var menu=div.lastElementChild||div.lastChild;return null==menu?(alert("menu is null then return and target is "+div),void 0):(""!=menu.style.visibility&&"hidden"!=menu.style.visibility?(menu.style.visibility="hidden",div.className="toolbar-item-transfer"):(menu.style.visibility="visible",div.className="toolbar-item-selected"),void 0)}function Menu(id,item_div){var table=document.createElement("table");table.className="toolbar-menu",table.id=id+"Table";var mytablebody=document.createElement("tbody");table.appendChild(mytablebody),jQuery("#"+id).find("span").length>0&&(table.onclick=function(event){displayMenu(event)}),item_div.appendChild(table),this.table=table,this.addItem=function(title,action,imageName,alt){var itemTd=document.createElement("td");itemTd.innerHTML=genIconElement(action,imageName)+title,itemTd.onmouseout=MouseOutMenuItem,itemTd.onmouseover=MouseOverMenuItem,itemTd.title=alt||title,setAction(itemTd,action),itemTd.className="toolbar-menuitem",itemTd.width="100%";var tr=document.createElement("tr");tr.appendChild(itemTd),0==this.table.tBodies.length&&this.table.appendChild(document.createElement("tbody")),this.table.tBodies[0].appendChild(tr)}}function MouseOutMenuItem(e){for(var o=bg.event.getTarget(e);o&&"td"!=o.tagName.toLowerCase();)o=o.parentNode;o&&(o.className="toolbar-menuitem")}function MouseOverMenuItem(e){for(var o=bg.event.getTarget(e);o&&"td"!=o.tagName.toLowerCase();)o=o.parentNode;o&&(o.className="toolbar-menuitem-transfer")}function MouseOverItem(e){for(var o=bg.event.getTarget(e);o&&"div"!=o.tagName.toLowerCase();)o=o.parentNode;o&&jQuery(o).removeClass("toolbar-item").addClass("toolbar-item-transfer")}function MouseOutItem(e){for(var o=bg.event.getTarget(e);o&&"div"!=o.tagName.toLowerCase();)o=o.parentNode;o&&jQuery(o).removeClass("toolbar-item-transfer").removeClass("toolbar-item-selected").addClass("toolbar-item")}if(this.itemCount=0,this.bar=document.getElementById(divId),null!=this.bar){this.id=divId,this.separator="&nbsp;",this.bar.className="toolbar notprint";var imageRoot=self.location.pathname.substring(0,self.location.pathname.substring(1).indexOf("/")+1)+"/static/themes/"+bg.uitheme+"/icons/",imagePath=imageRoot+"16x16/actions/";this.setTitle=function(newTitle,imageName){newTitle&&(null==imageName&&(imageName="action-info"),this.title_div.innerHTML=genIconElement(null,imageName)+"<strong>"+newTitle+"</strong>")},this.setSeparator=function(separator){this.separator=separator},this.init=function(title,imageName){var msg_div,items_div,title_div=document.createElement("div");title_div.className="toolbar-title",this.bar.appendChild(title_div),this.title_div=title_div,this.setTitle(title,imageName),items_div=document.createElement("div"),items_div.className="toolbar-items",items_div.id=this.id+"_items",this.items_div=items_div,this.bar.appendChild(items_div),msg_div=document.createElement("div"),msg_div.className="toolbar-msg",msg_div.style.display="none",msg_div.id=this.id+"_msg",this.bar.appendChild(msg_div)},this.init(title,imageName),this.addHr=function(){hrdiv=this.appendDiv(null,"toolbar-line"),hrdiv.innerHTML='<img height="1" width="100%" align="top" src="'+imagePath+'keyline.png" />'},this.addBack=function(title){null==title?this.addItem("返回",function(){history.back(-1)},"action-backward"):this.addItem(title,function(){history.back(-1)},"action-backward")},this.addHelp=function(module){this.addItem("帮助",function(){null==module?bg.alert("施工中.."):window.open("help.action?helpId="+module)},"action-help-contents")},this.addPrint=function(msg){null==msg?this.addItem("打印","print()"):this.addItem(msg,"print()")},this.addClose=function(msg){(""==msg||null==msg)&&(msg="关闭"),this.addItem(msg,"window.close()","action-close")},this.addItem=function(title,action,imageName,alt,objectCount){this.addSeparatorAsNeed();var item_div=document.createElement("div");return item_div.innerHTML=genIconElement(action,imageName)+title,item_div.onmouseout=MouseOutItem,item_div.onmouseover=MouseOverItem,setAction(item_div,action),objectCount||"object"==typeof action&&(objectCount=action.objectCount),objectCount||(objectCount="ge0"),item_div.className="toolbar-item toolbar-item-"+objectCount+("ge0"!=objectCount?" toolbar-item-disabled":""),item_div.title=null==alt?title:alt,this.items_div.appendChild(item_div),this.itemCount++,item_div},this.addDiv=function(className){var newDiv=document.createElement("div");return className&&(newDiv.className=className),this.items_div.appendChild(newDiv),newDiv},this.appendDiv=function(id,className){var newDiv=document.createElement("div");return id&&newDiv.setAttribute("id",id),className&&(newDiv.className=className),document.getElementById(this.id).appendChild(newDiv),newDiv},this.addSeparator=function(){this.separator&&(this.addDiv("toolbar-separator").innerHTML=this.separator)},this.addSeparatorAsNeed=function(){0!=this.itemCount&&this.addSeparator()},this.addBackOrClose=function(backCaption,closeCaption){parent.location==self.location&&(window.history.length<=1||null==window.history.length)?this.addClose(null==closeCaption?"关闭":closeCaption):this.addBack(null==backCaption?"后退":backCaption)},this.addBlankItem=function(){this.addDiv("toolbar-group-separator").innerHTML="&nbsp;",this.itemCount++},this.setMessage=function(msg){"undefined"!=typeof msg&&(document.getElementById(this.id+"_msg").innerHTML=msg)},this.addMenu=function(title,action,imageName,alt){this.addSeparatorAsNeed();var item_div=document.createElement("div");item_div.className="toolbar-item";var menuTableId=this.id+this.itemCount+"_menu";if(item_div.id=menuTableId,item_div.tabIndex=0,item_div.title=alt||title,item_div.onmouseout=MouseOutItem,item_div.onmouseover=MouseOverItem,this.items_div.appendChild(item_div),null==action)item_div.innerHTML=genIconElement(null,imageName)+title+"&nbsp;"+genIconElement(null,"action-downarrow"),item_div.onclick=function(event){displayMenu(event)};else{var span1=document.createElement("span");span1.innerHTML=genIconElement(action,imageName)+title,setAction(span1,action);var span2=document.createElement("span");span2.innerHTML=genIconElement(action,"action-downarrow"),span2.onclick=function(event){displayMenu(event)},item_div.appendChild(span1),item_div.appendChild(span2)}item_div.onblur=function(event){hiddenMenu(event)};var menu=new Menu(menuTableId,item_div);return this.itemCount++,menu}}}function EntityAction(entity,onePage){function applyMethod(action,method){var last1=action.lastIndexOf("!"),lastDot=action.lastIndexOf("."),shortAction=action,sufix="";return-1==last1&&(last1=lastDot),-1!=last1&&(shortAction=action.substring(0,last1)),-1!=lastDot&&(sufix=action.substring(lastDot)),shortAction+"!"+method+sufix}this.entity=entity,this.page=onePage,this.formid="form_"+bg.randomInt();var selfaction=this;if(this.getForm=function(){return this.page.getForm()},this.addParam=function(name,value){bg.form.addInput(this.getForm(),name,value)},null!=this.page.target&&""!=this.page.target){var fm=this.getForm();null!=fm&&(fm.target=this.page.target)}this.beforeSubmmitId=function(method){var ids=bg.input.getCheckBoxValues(entity+".id");if(null==ids||""==ids)return bg.alert("你没有选择要操作的记录！"),!1;var form=this.getForm();return form.action=applyMethod(this.page.actionurl,method),this.page.paramstr&&(bg.form.addHiddens(form,this.page.paramstr),bg.form.addParamsInput(form,this.page.paramstr)),!0},this.submitIdAction=function(method,multiId,confirmMsg,ajax){if(this.beforeSubmmitId(method)){if(null!=confirmMsg&&""!=confirmMsg&&!confirm(confirmMsg))return;bg.form.submitId(this.getForm(),this.entity+".id",multiId,null,null,ajax)}},this.remove=function(confirmMsg){return confirmMsg=confirmMsg||"确认删除?",new NamedFunction("remove",function(){selfaction.submitIdAction("remove",!0,confirmMsg)},bg.ui.grid.enableDynaBar?"ge1":"ge0")},this.add=function(){return new NamedFunction("add",function(){var form=selfaction.getForm();""!=selfaction.page.paramstr&&bg.form.addHiddens(form,selfaction.page.paramstr),bg.form.addInput(form,selfaction.entity+".id",""),""!=selfaction.page.paramstr&&bg.form.addParamsInput(form,selfaction.page.paramstr),bg.form.submit(form,applyMethod(selfaction.page.actionurl,"edit"))})},this.info=function(){return new NamedFunction("info",function(){selfaction.submitIdAction("info",!1)},bg.ui.grid.enableDynaBar?"e1":"ge0")},this.edit=function(){return new NamedFunction("edit",function(){selfaction.submitIdAction("edit",!1)},bg.ui.grid.enableDynaBar?"e1":"ge0")},this.single=function(methodName,confirmMsg,extparams){return new NamedFunction(methodName,function(){var form=selfaction.getForm();null!=extparams&&bg.form.addHiddens(form,extparams),selfaction.submitIdAction(methodName,!1,confirmMsg)},bg.ui.grid.enableDynaBar?"e1":"ge0")},this.multi=function(methodName,confirmMsg,extparams,ajax){return new NamedFunction(methodName,function(){try{var form=selfaction.getForm();null!=extparams&&bg.form.addHiddens(form,extparams),selfaction.submitIdAction(methodName,!0,confirmMsg,ajax)}catch(e){bg.alert(e)}},bg.ui.grid.enableDynaBar?"ge1":"ge0")},this.method=function(methodName,confirmMsg,extparams,ajax){return new NamedFunction(methodName,function(){var form=selfaction.getForm();(null==confirmMsg||""==confirmMsg||confirm(confirmMsg))&&(null!=extparams&&bg.form.addHiddens(form,extparams),""!=selfaction.page.paramstr&&(bg.form.addHiddens(form,selfaction.page.paramstr),bg.form.addParamsInput(form,selfaction.page.paramstr)),bg.form.submit(form,applyMethod(selfaction.page.actionurl,methodName),null,null,ajax))})},this.exportData=function(properties,format,extparams){return format=format||"xls",properties=properties||"",extparams=extparams||"",0!=extparams.indexOf("&")&&(extparams="&"+extparams),extparams="&format="+format+"&properties="+properties+extparams,selfaction.method("export",null,extparams,!1)}}bg.alert=function(msg){alert(msg)},bg.uitheme="default",bg.extend({"ui.toolbar":function(divId,title,imageName){return new ToolBar(divId,title,imageName)}}),bg.extend({"ui.gridbar":function(divIds,title){function menus(title,action,imageName,alt,bars){for(var menu=new Array,i=0;i<bars.length;i++)menu[i]=bars[i].addMenu(title,action,imageName,alt);this.addItem=function(title,action,imageName,alt){for(var i=0;i<menu.length;i++)menu[i].addItem(title,action,imageName,alt)}}this.divIds=divIds,this.pageId=null,this.title=title,this.toolbars=[];for(var i=0;i<divIds.length;i++)this.toolbars[i]=bg.ui.toolbar(divIds[i],title),this.toolbars[i].setSeparator(""),document.getElementById(divIds[i]).className="gridbar",document.getElementById(divIds[i]+"_items").className="gridbar-items";this.pageId=function(givenId){return this.pageId=givenId,this},this.addItem=function(title,action,imageName,alt){for(var i=0;i<this.toolbars.length;i++)this.toolbars[i].addItem(title,action,imageName,alt)},this.addBack=function(title){for(var i=0;i<this.toolbars.length;i++)this.toolbars[i].addBack(title)},this.addBackOrClose=function(){for(var i=0;i<this.toolbars.length;i++)this.toolbars[i].addBackOrClose()},this.addBlankItem=function(title,action,imageName,alt){for(var i=0;i<this.toolbars.length;i++)this.toolbars[i].addBlankItem(title,action,imageName,alt)},this.addPage=function(onePage,ranks,titles){this.myPage=onePage;for(var i=0;i<this.toolbars.length;i++)pageDiv=this.toolbars[i].appendDiv(divIds[i]+"_page","girdbar-pgbar"),bg.ui.pagebar(onePage,pageDiv,ranks,titles);return this},this.addEntityAction=function(entity,onePage){return new bg.entityaction(entity,onePage)},this.addPrint=function(msg){for(var i=0;i<this.toolbars.length;i++)this.toolbars[i].addPrint(msg)},this.addMenu=function(title,action,imageName,alt){return new menus(title,action,imageName,alt,this.toolbars)}}}),bg.extend({"ui.pagebar":function(onePage,pageDiv,ranks,titles){if(0!=onePage.total){ranks?0==ranks.length&&(ranks=[onePage.pageSize]):ranks=[10,20,30,50,70,100,200,500,1e3],titles||(titles={first:"« First",previous:"‹ Previous",next:"Next ›",last:"Last »",no:"No:",size:"Size:",change:"Click me to change page size",pagesize:"Page Size"});var maxPageNo=onePage.maxPageNo;addAnchor=function(text,pageNumber){var pageHref=document.createElement("a");pageHref.setAttribute("href","javascript:void(0)"),pageHref.innerHTML=text,pageHref.style.padding="0px 2px 0px 2px",pageDiv.appendChild(pageHref),jQuery(pageHref).click(function(){onePage.goPage(pageNumber)})},onePage.pageNo>1&&(addAnchor(titles.first,1),addAnchor(titles.previous,onePage.pageNo-1));var labelspan=document.createElement("span");labelspan.innerHTML="<strong>"+onePage.startNo+"</strong> - <strong>"+onePage.endNo+"</strong> of <strong>"+onePage.total+"</strong>",labelspan.style.padding="0px 2px 0px 2px",pageDiv.appendChild(labelspan);var numSpan=jQuery(labelspan);numSpan.attr("title",titles.change),numSpan.mouseover(function(){this.className="pgbar-label"}),numSpan.mouseout(function(){this.className=""}),numSpan.click(function(){this.parentNode.style.marginTop="0px",this.nextSibling.style.display="",this.style.display="none"});var pagespan=document.createElement("span");if(pagespan.style.display="none",ranks&&ranks.length>0){var pageNoSelect=document.createElement("select");pageNoSelect.id=pageDiv.id+"_select",pagespan.appendChild(pageNoSelect),pageNoSelect.className="pgbar-selbox",pageNoSelect.title=titles.pagesize||"Page Size";for(var selectIndex=0,i=0;i<ranks.length;i++)ranks[i]==onePage.pageSize&&(selectIndex=i),pageNoSelect.options.add(new Option(titles.size+ranks[i],ranks[i]));pageNoSelect.selectedIndex=selectIndex}var pageInput=document.createElement("input");pageInput.className="pgbar-input",pagespan.appendChild(pageInput);var pageInputLabel=document.createElement("label");pagespan.appendChild(pageInputLabel),jQuery(pageInputLabel).attr("for",pageDiv.id+"_input").text("/"+maxPageNo+" ").toggleClass("pgbar-input-label");var pageInputJ=jQuery(pageInput);pageInputJ.attr("value",onePage.pageNo),pageInputJ.attr("id",pageDiv.id+"_input"),pageInputJ.attr("title",onePage.startNo+" - "+onePage.endNo+" of "+onePage.total),pageInputJ.focus(function(){this.value=""}),pageInputJ.blur(function(){this.value||(this.value=onePage.pageNo)});var submitBtn=document.createElement("input");submitBtn.setAttribute("type","button"),submitBtn.setAttribute("name","gogo"),submitBtn.value="Go",submitBtn.className="pgbar-go",pagespan.appendChild(submitBtn);var changePage=function(){var pageNo=document.getElementById(pageDiv.id+"_input").value,endIndex=pageNo.indexOf("/"+onePage.maxPageNo);-1!=endIndex&&(pageNo=pageNo.substring(0,endIndex)),onePage.goPage(pageNo,document.getElementById(pageDiv.id+"_select").value)};jQuery(submitBtn).click(function(){changePage()}),pageDiv.appendChild(pagespan),jQuery(pagespan).keypress(function(event){return event||(event=window.event),event&&event.keyCode&&13==event.keyCode?(changePage(),!1):void 0}),onePage.pageNo<onePage.maxPageNo&&(addAnchor(titles.next,onePage.pageNo+1),addAnchor(titles.last,onePage.maxPageNo))}}}),bg.extend({"ui.grid":{enableSingleRowSelect:!1,enableDynaBar:!1,enableSelectTip:!0,overSortTableHeader:function(){this.style.color="white",this.style.backgroundColor="green"},outSortTableHeader:function(){this.style.borderColor="",this.style.color="",this.style.backgroundColor=""},mouseOverGrid:function(){if("undefined"!=typeof this.className){var myclass=this.className;selectIndex=myclass.indexOf("griddata-selected"),-1==selectIndex&&(overIndex=myclass.indexOf("griddata-over"),this.className=-1==overIndex?myclass+" "+"griddata-over":myclass.substring(0,overIndex))}},setGridMessage:function(gridId,message){var msgDiv1=document.getElementById(gridId+"_bar1_msg"),msgDiv2=document.getElementById(gridId+"_bar2_msg");msgDiv1&&(msgDiv1.style.display=message?"":"none",msgDiv1.innerHTML=message?message:""),msgDiv2&&(msgDiv2.style.display=message?"":"none",msgDiv2.innerHTML=message?message:"")},toggleAll:function(event){for(var ele=bg.event.getTarget(event),ownGridTable=ele;null!=ownGridTable.tagName&&"table"!=ownGridTable.tagName.toLowerCase()&&(ownGridTable=ownGridTable.parentNode,null!=ownGridTable););if(ele.parentNode,null!=ownGridTable){var selectedCount=0;jQuery("#"+ownGridTable.id+" .gridselect").each(function(){var inputs=jQuery(this).find("input");0!=inputs.length&&(ele.checked?(inputs.attr("checked","checked"),jQuery(this).parent("tr").addClass("griddata-selected"),selectedCount++):inputs.is(":checked")&&(inputs.removeAttr("checked"),jQuery(this).parent("tr").removeClass("griddata-selected")))}),bg.ui.grid.notifyGridbar(ownGridTable.id,selectedCount)}},notifyGridbar:function(gridId,selectedCount){var changeToolbarItem=function(){selectedCount>=2?jQuery(this).hasClass("toolbar-item-e1")?jQuery(this).addClass("toolbar-item-disabled"):jQuery(this).removeClass("toolbar-item-disabled"):1==selectedCount?jQuery(this).hasClass("toolbar-item-ge2")?jQuery(this).addClass("toolbar-item-disabled"):jQuery(this).removeClass("toolbar-item-disabled"):jQuery(this).hasClass("toolbar-item-ge0")?jQuery(this).removeClass("toolbar-item-disabled"):jQuery(this).addClass("toolbar-item-disabled")};bg.ui.grid.enableDynaBar&&(jQuery("#"+gridId+"_bar1_items .toolbar-item").each(changeToolbarItem),jQuery("#"+gridId+"_bar2_items .toolbar-item").each(changeToolbarItem)),bg.ui.grid.enableSelectTip&&(selectedCount>1?bg.ui.grid.setGridMessage(gridId,"已选择 <b>"+selectedCount+"</b> 条"):bg.ui.grid.setGridMessage(gridId,""))},toggleRow:function(event){for(var ele=bg.event.getTarget(event),ownGridTable=ele;null!=ownGridTable.tagName&&"table"!=ownGridTable.tagName.toLowerCase()&&(ownGridTable=ownGridTable.parentNode,null!=ownGridTable););var changed=!0,firstCell=null,isFireOnBoxCell=!1;if(null!=ele&&"td"==ele.tagName.toLowerCase()){for(firstCell=ele.parentNode.firstChild;null==firstCell.tagName||"td"!=firstCell.tagName.toLowerCase();)firstCell=firstCell.nextSibling;for(isFireOnBoxCell=ele==firstCell,ele=firstCell.firstChild;"undefined"==typeof ele.tagName||"input"!=ele.tagName.toLowerCase();)if(ele=ele.nextSibling,null==ele)return;ele.checked=!ele.checked}else"checkbox"==ele.type||"radio"==ele.type?(firstCell=ele.parentNode,isFireOnBoxCell=!0):changed=!1;if(null!=ele&&null!=firstCell&&null!=ownGridTable&&changed){var row=firstCell.parentNode;if("undefined"!=typeof row.className){ele.checked?jQuery(row).removeClass("griddata-over").addClass("griddata-selected"):jQuery(row).removeClass("griddata-selected").addClass("griddata-over");var selectedCount=0;if("radio"==ele.type)ele.checked&&(selectedCount=1);else{var isReserveOtherSelect=!bg.ui.grid.enableSingleRowSelect||isFireOnBoxCell||event.ctrlKey;jQuery("#"+ownGridTable.id+" .gridselect").each(function(){jQuery(this).find("input").is(":checked")&&(firstCell==this||isReserveOtherSelect?selectedCount++:(jQuery(this).find("input").removeAttr("checked"),jQuery(this).parent("tr").removeClass("griddata-selected")))}),isReserveOtherSelect||jQuery("#"+ownGridTable.id+" .gridselect-top").each(function(){jQuery(this).find("input").removeAttr("checked")})}bg.ui.grid.notifyGridbar(ownGridTable.id,selectedCount),"function"==typeof ele.onchange&&ele.onchange()}}},sort:function(onePage,ele){if(null==onePage)return bg.alert("无法找到元素对应的排序表格！"),void 0;var orderByStr=null;orderByStr="gridhead-sortable"==ele.className?"undefined"!=typeof ele.asc?ele.asc:ele.id+" asc":"gridhead-asc"==ele.className?"undefined"!=typeof ele.desc?ele.desc:ele.id.replace(/\,/g," desc,")+" desc":"",onePage.goPage(1,null,orderByStr)},init:function(tableId,onePage){var tbody,orderBy,columnSort,i,j,head,row,cell,desc,asc,orignRowCls,table=document.getElementById(tableId),thead=table.tHead;if(thead&&0!=thead.rows.length){for(orderBy=onePage.orderby,columnSort=function(){bg.ui.grid.sort(onePage,this)},j=0;j<thead.rows.length;j++)for(head=thead.rows[j],i=0;i<head.cells.length;i++)if(cell=head.cells[i],"gridhead-sortable"==cell.className&&null!=cell.id){if(cell.onclick=columnSort,cell.onmouseover=bg.ui.grid.overSortTableHeader,cell.onmouseout=bg.ui.grid.outSortTableHeader,cell.title="点击按 ["+cell.innerHTML+"] 排序",desc=cell.id.replace(/\,/g," desc,")+" desc","undefined"!=typeof cell.desc&&(desc=cell.desc),-1!=orderBy.indexOf(desc)){cell.className="gridhead-desc",cell.innerHTML=cell.innerHTML+'<span class="gridhead-icon action-sort-desc"></span>';continue}if(asc=cell.id+" asc","undefined"!=typeof cell.asc&&(asc=cell.asc),orderBy==asc){cell.className="gridhead-asc",cell.innerHTML=cell.innerHTML+'<span class="gridhead-icon action-sort-asc"></span>';continue}}if(tbody=document.getElementById(tableId+"_data"))for(j=0;j<tbody.rows.length;j++)row=tbody.rows[j],orignRowCls=row.className,orignRowCls=orignRowCls?" "+orignRowCls:"",row.className=1==j%2?"griddata-odd"+orignRowCls:"griddata-even"+orignRowCls,row.onclick=bg.ui.grid.toggleRow,row.onmouseover=bg.ui.grid.mouseOverGrid,row.onmouseout=bg.ui.grid.mouseOverGrid}},fillEmpty:function(divId,pageSize,size,msg){var heightpx,emptyLabel,emptydiv=document.getElementById(divId),emptyCnt=pageSize-size;emptyCnt>7&&(emptyCnt=7),heightpx=16*emptyCnt,0==size&&(emptyLabel=document.createElement("div"),emptyLabel.innerHTML=msg||"No result matched your search.",emptyLabel.style.paddingTop=heightpx/2-16+"px",emptydiv.appendChild(emptyLabel)),emptydiv.style.height=heightpx+"px"}}}),bg.extend({entityaction:EntityAction}),bg.extend({"ui.module":{moduleClick:function(moudleId){var id=document.getElementById(moudleId);id.className="module collapsed"==id.className?"module expanded":"module collapsed"}}}),bg.extend({"ui.load":function(module,callback){var base=bg.getContextPath();"validity"==module?(jQuery.struts2_jquery.requireCss("/static/themes/"+bg.uitheme+"/jquery.validity.css",base),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-validity-1.3.1.js",null,base),jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery.validity.js",callback,base)):"tabletree"==module?(jQuery.struts2_jquery.requireCss("/static/themes/"+bg.uitheme+"/beangle-ui-tabletree.css",base),jQuery.struts2_jquery.require("/static/scripts/beangle/beangle-ui-tabletree-3.3.3.js",callback,base)):"colorbox"==module?(jQuery.struts2_jquery.requireCss("/static/themes/"+bg.uitheme+"/colorbox.css",base),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-colorbox-1.4.27.min.js",callback,base)):"jquery.pstrength"==module&&(jQuery.struts2_jquery.requireCss("/static/themes/"+bg.uitheme+"/jquery-pstrength.css",base),jQuery.struts2_jquery.require("/static/scripts/jquery/jquery-pstrength-2.1.js",callback,base),jQuery.struts2_jquery.require("/static/scripts/i18n/zh_CN/jquery-pstrength.js",callback,base))}})}(beangle);