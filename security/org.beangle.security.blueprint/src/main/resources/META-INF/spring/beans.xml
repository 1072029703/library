<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
	
	<bean id="sessionController" class="org.beangle.security.web.session.category.MemCategorySessionController" autowire="byName"></bean>
	
	<bean id="sessionRegistry" class="org.beangle.security.web.session.category.CategorySessionRegistry" autowire="byName">
		<property name="innerRegistry">
			<bean class="org.beangle.security.core.session.MemSessionRegistry"/>
		</property>
	</bean>
	
	<bean id="sessionStrategy" class="org.beangle.security.web.session.ConcurrentSessionStrategy" autowire="byName">
		<property name="sessionController" ref="sessionController"/>
	</bean>
	
	<bean id="passwordEncoder" class="org.beangle.security.auth.encoding.DigestPasswordEncoder">
		<property name="algorithm" value="MD5"/>
	</bean>
	
	<bean id="daoUserProvider" class="org.beangle.security.auth.dao.DaoAuthenticationProvider"
	 autowire="byName"/>
	
	<bean id="preauthUserDetailProvider" class="org.beangle.security.web.auth.preauth.PreauthUserDetailProvider"
	 autowire="byName"/>
	
	<bean id="remoteUsernameSource" class="org.beangle.security.web.auth.preauth.j2ee.RemoteUsernameSource"/>
	
	<bean id="usernamePreauthFilter" class="org.beangle.security.web.auth.preauth.UsernamePreauthFilter" autowire="byName">
		<property name="usernameSource" ref="remoteUsernameSource"/>
	</bean>
	
	<!--why name required?-->
	<bean id="authenticationmanager" name="authenticationManager" class="org.beangle.security.auth.ProviderManager" autowire="byName">
		<property name="providers">
			<list>
				<ref bean="preauthUserDetailProvider"/>
				<ref bean="daoUserProvider"/>
			</list>
		</property>
	</bean>
	
	<bean id="httpSessionContextIntegrationFilter" class="org.beangle.security.web.context.HttpSessionContextIntegrationFilter"/>
	
	<bean id="filterSecurityInterceptor" class="org.beangle.security.web.access.intercept.FilterSecurityInterceptor" autowire="byName"/>
	
	<bean id="anonymousFilter" class="org.beangle.security.web.auth.AnonymousAuthenticationFilter"></bean>
	
	<bean id="concurrentSessionFilter" class="org.beangle.security.web.session.ConcurrentSessionFilter">
		<property name="sessionRegistry" ref="sessionRegistry"/>
	</bean>
	
	<bean id="accessDeniedHandler" class="org.beangle.security.web.access.DefaultAccessDeniedHandler">
		<property name="errorPage" value="/error.action"/>
	</bean>
	
	<bean id="exceptionTranslationFilter" class="org.beangle.security.web.access.ExceptionTranslationFilter">
		<property name="authenticationEntryPoint" ref="authenticationEntryPoint"/>
		<property name="accessDeniedHandler" ref="accessDeniedHandler"/>
	</bean>
	
	<bean id="authenticationEntryPoint" class="org.beangle.security.web.auth.LoginUrlEntryPoint">
		<property name="loginUrl" value="/login.action"/>
	</bean>
	
	<bean id="securityFilterChain" class="org.beangle.security.web.FilterChainProxy">
		<property name="filterChainMap">
			<map>
				<entry>
					<key>
						<bean class="org.beangle.web.filter.AntPathRequestMatcher">
							<constructor-arg value="/**"/>
						</bean>
					</key>
					<list>
						<ref bean="httpSessionContextIntegrationFilter"/>
						<ref bean="usernamePreauthFilter"/>
						<ref bean="anonymousFilter"/>
						<ref bean="exceptionTranslationFilter"/>
						<ref bean="filterSecurityInterceptor"/>
					</list>
				</entry>
			</map>
		</property>
	</bean>
	
	<bean id="securityContextLogoutHandler" class="org.beangle.security.web.auth.logout.SecurityContextLogoutHandler"/>
	
	<bean id="logoutHandlerStack" class="org.beangle.security.web.auth.logout.LogoutHandlerStack">
		<property name="handlers">
			<list>
				<ref bean="securityContextLogoutHandler"/>
			</list>
		</property>
	</bean>
	<bean id="authenticationDetailsSource" class="org.beangle.security.web.auth.WebAuthenticationDetailsSource"/>
	
	<!--blueprint management service-->
	<bean id="userService" class="org.beangle.security.blueprint.service.UserServiceImpl" autowire="byName"/>
	
	<bean id="authorityService" class="org.beangle.security.blueprint.service.AuthorityServiceImpl" autowire="byName"/>
	
	<bean id="restrictionService" class="org.beangle.security.blueprint.restrict.service.RestrictionServiceImpl" autowire="byName"/>
	
	<bean id="userDetailService" class="org.beangle.security.blueprint.service.DaoUserDetailServiceImpl" autowire="byName"/>
	
	<bean id="authorityManager" class="org.beangle.security.blueprint.service.CacheableAuthorityManager" autowire="byName"/>
	
	<bean id="profileProvider" class="org.beangle.security.blueprint.service.MultiSessionProfileProvider" autowire="byName"/>
	
</beans>
