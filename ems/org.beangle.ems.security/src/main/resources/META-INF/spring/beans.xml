<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
	
	<bean id="ems.security.defaultmodule" class="org.beangle.ems.security.DefaultModule"></bean>
	
	<!--why name required?-->
	<bean id="authenticationmanager" name="authenticationManager" class="org.beangle.security.auth.ProviderManager" autowire="byName">
		<property name="providers">
			<list>
				<ref bean="preauthUserDetailProvider"/>
				<ref bean="daoAuthenticationProvider"/>
			</list>
		</property>
	</bean>
	
	<bean id="authenticationEntryPoint" class="org.beangle.security.web.auth.LoginUrlEntryPoint">
		<property name="loginUrl" value="/login.action"/>
	</bean>
	
	<bean id="securityFilterChain" class="org.beangle.security.web.FilterChainProxy">
		<property name="filters">
			<list>
				<ref bean="httpSessionContextIntegrationFilter"/>
				<ref bean="accessLogFilter"/>
				<ref bean="usernamePreauthFilter"/>
				<ref bean="anonymousFilter"/>
				<ref bean="exceptionTranslationFilter"/>
				<ref bean="concurrentSessionFilter"/>
				<ref bean="filterSecurityInterceptor"/>
			</list>
		</property>
	</bean>

	
	<bean id="logoutHandlerStack" class="org.beangle.security.web.auth.logout.LogoutHandlerStack">
		<property name="handlers">
			<list>
				<ref bean="securityContextLogoutHandler"/>
			</list>
		</property>
	</bean>
	
	<bean id="restrictionService" class="org.beangle.ems.security.restrict.service.RestrictionServiceImpl" autowire="byName">
		<property name="providers">
			<map>
				<entry key="csv" value-ref="csvDataResolver"/>
				<entry key="oql" value-ref="oqlDataProvider"/>
			</map>
		</property>
		<property name="dataResolver" ref="identifierDataResolver"/>
	</bean>
	
</beans>
